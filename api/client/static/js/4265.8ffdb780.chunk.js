"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[4265],{65630:function(e,t,n){n.d(t,{D:function(){return ve},b:function(){return me}});var r,o,a,i,s,l,c,u,d,p,m,v,f,h,g,x,y,b,C,T,w,M,S,O=n(30168),A=n(92026),_=n(81949),H=n(22357),N=n(83734),P=n(71011),L=n(33280),Z=n(94951),R=n(81221),D=n(73782),E=n(52276),I=n(53230),B=n(60113),z=n(48655),F=n(85380),V=n(49223),k=n(6781),G=n(38171),q=n(30694),J=n(34975),W=n(15226),U=n(96658),j=n(2116),K=n(41481),X=n(87920),$=n(18607),Q=n(26461),Y=n(65974),ee=n(14282),te=n(71033),ne=n(82552),re=n(49450),oe=n(95276),ae=n(58406),ie=n(98634),se=n(8654),le=n(64201),ce=n(19253),ue=n(68401),de=n(4760),pe=n(48919);function me(e){var t=new le.kG,n=t.vertex.code,me=t.fragment.code;t.include(ee.a,{name:"Default Material Shader",output:e.output});var ve=(0,ne.S)(t,e);return t.include(E.f),t.varyings.add("vpos","vec3"),t.include($.k,e),t.include(R.f,e),t.include(V.L,e),e.output!==P.H.Color&&e.output!==P.H.Alpha||((0,ne.h)(t.vertex,e),t.include(D.O,e),t.include(Z.w,{linearDepth:!1,hasModelTransformation:e.hasModelTransformation}),e.normalType===D.h.Attribute&&e.offsetBackfaces&&t.include(N.w),t.include(G.Q,e),t.include(F.Bb,e),e.instancedColor&&t.attributes.add(de.T.INSTANCECOLOR,"vec4"),t.varyings.add("localvpos","vec3"),t.include(B.D,e),t.include(H.q,e),t.include(I.R,e),t.include(z.c,e),t.vertex.uniforms.add(new oe.N("externalColor",(function(e){return e.externalColor}))),t.varyings.add("vcolorExt","vec4"),e.hasMultipassTerrain&&t.varyings.add("depth","float"),e.hasModelTransformation&&t.vertex.uniforms.add(new se.g("model",(function(e){return(0,A.pC)(e.modelTransformation)?e.modelTransformation:_.I}))),n.add((0,ie.H)(r||(r=(0,O.Z)(["\n      void main(void) {\n        forwardNormalizedVertexColor();\n        vcolorExt = externalColor;\n        ","\n        vcolorExt *= vvColor();\n        vcolorExt *= getSymbolColor();\n        forwardColorMixMode();\n\n        if (vcolorExt.a < ",") {\n          gl_Position = vec4(1e38, 1e38, 1e38, 1.0);\n        } else {\n          vpos = calculateVPos();\n          localvpos = vpos - view[3].xyz;\n          vpos = subtractOrigin(vpos);\n          ","\n          vpos = addVerticalOffset(vpos, localOrigin);\n          ","\n          gl_Position = transformPosition(proj, view, "," vpos);\n          ","\n        }\n\n        ","\n        forwardLinearDepth();\n        forwardTextureCoordinates();\n      }\n    "])),e.instancedColor?"vcolorExt *= instanceColor;":"",ie.H.float(Q.b),e.normalType===D.h.Attribute?(0,ie.H)(o||(o=(0,O.Z)(["vNormalWorld = dpNormal(vvLocalNormal(normalModel()));"]))):"",e.hasVertexTangents?"vTangent = dpTransformVertexTangent(tangent);":"",e.hasModelTransformation?"model,":"",e.normalType===D.h.Attribute&&e.offsetBackfaces?"gl_Position = offsetBackfacingClipPosition(gl_Position, vpos, vNormalWorld, cameraPosition);":"",e.hasMultipassTerrain?"depth = (view * vec4(vpos, 1.0)).z;":""))),e.output===P.H.Alpha&&(t.include(L.f5,e),t.include(Y.z,e),t.include(W.l,e),t.fragment.uniforms.add([new ae.p("opacity",(function(e){return e.opacity})),new ae.p("layerOpacity",(function(e){return e.layerOpacity}))]),e.hasColorTexture&&t.fragment.uniforms.add(new ce.A("tex",(function(e){return e.texture}))),t.fragment.include(te.y),me.add((0,ie.H)(a||(a=(0,O.Z)(["\n      void main() {\n        discardBySlice(vpos);\n        ","\n        ","\n        ","\n        gl_FragColor = vec4(opacity_);\n      }\n    "])),e.hasMultipassTerrain?"terrainDepthTest(gl_FragCoord, depth);":"",e.hasColorTexture?(0,ie.H)(i||(i=(0,O.Z)(["\n                vec4 texColor = texture2D(tex, vuv0);\n                ","\n                discardOrAdjustAlpha(texColor);"])),e.textureAlphaPremultiplied?"texColor.rgb /= texColor.a;":""):(0,ie.H)(s||(s=(0,O.Z)(["vec4 texColor = vec4(1.0);"]))),e.hasVertexColors?(0,ie.H)(l||(l=(0,O.Z)(["float opacity_ = layerOpacity * mixExternalOpacity(vColor.a * opacity, texColor.a, vcolorExt.a, int(colorMixMode));"]))):(0,ie.H)(c||(c=(0,O.Z)(["float opacity_ = layerOpacity * mixExternalOpacity(opacity, texColor.a, vcolorExt.a, int(colorMixMode));"])))))),e.output===P.H.Color&&(t.include(L.f5,e),t.include(J.X,e),t.include(q.K,e),t.include(Y.z,e),t.include(e.instancedDoublePrecision?X.hb:X.XE,e),t.include(W.l,e),(0,ne.h)(t.fragment,e),t.fragment.uniforms.add([ve,new re.J("ambient",(function(e){return e.ambient})),new re.J("diffuse",(function(e){return e.diffuse})),new ae.p("opacity",(function(e){return e.opacity})),new ae.p("layerOpacity",(function(e){return e.layerOpacity})),new ae.p("lightingGlobalFactor",(function(e,t){return t.lighting.globalFactor})),new re.J("lightingMainIntensity",(function(e,t){return t.lighting.mainLight.intensity}))]),t.fragment.constants.add("ambientBoostFactor","float",pe.V),e.hasColorTexture&&t.fragment.uniforms.add(new ce.A("tex",(function(e){return e.texture}))),t.include(K.jV,e),t.include(j.T,e),t.fragment.include(te.y),t.include(U.k,e),me.add((0,ie.H)(u||(u=(0,O.Z)(["\n      void main() {\n        discardBySlice(vpos);\n        ","\n        ","\n        shadingParams.viewDirection = normalize(vpos - cameraPosition);\n        ","\n        ","\n        float ssao = evaluateAmbientOcclusionInverse();\n        ssao *= getBakedOcclusion();\n\n        float additionalAmbientScale = additionalDirectedAmbientLight(vpos + localOrigin);\n        ","\n        vec3 matColor = max(ambient, diffuse);\n        ","\n        ","\n        vec3 normalGround = ","\n\n        ","\n\n        vec3 additionalLight = ssao * lightingMainIntensity * additionalAmbientScale * ambientBoostFactor * lightingGlobalFactor;\n\n        ","\n        gl_FragColor = highlightSlice(vec4(shadedColor, opacity_), vpos);\n        ","\n      }\n    "])),e.hasMultipassTerrain?"terrainDepthTest(gl_FragCoord, depth);":"",e.hasColorTexture?(0,ie.H)(d||(d=(0,O.Z)(["\n                vec4 texColor = texture2D(tex, vuv0);\n                ","\n                discardOrAdjustAlpha(texColor);"])),e.textureAlphaPremultiplied?"texColor.rgb /= texColor.a;":""):(0,ie.H)(p||(p=(0,O.Z)(["vec4 texColor = vec4(1.0);"]))),e.normalType===D.h.ScreenDerivative?(0,ie.H)(m||(m=(0,O.Z)(["\n                vec3 normal = screenDerivativeNormal(localvpos);"]))):(0,ie.H)(v||(v=(0,O.Z)(["\n                shadingParams.normalView = vNormalWorld;\n                vec3 normal = shadingNormal(shadingParams);"]))),e.pbrMode===K.f7.Normal?"applyPBRFactors();":"",e.receiveShadows?"float shadow = readShadowMap(vpos, linearDepth);":e.spherical?"float shadow = lightingGlobalFactor * (1.0 - additionalAmbientScale);":"float shadow = 0.0;",e.hasVertexColors?(0,ie.H)(f||(f=(0,O.Z)(["\n                vec3 albedo = mixExternalColor(vColor.rgb * matColor, texColor.rgb, vcolorExt.rgb, int(colorMixMode));\n                float opacity_ = layerOpacity * mixExternalOpacity(vColor.a * opacity, texColor.a, vcolorExt.a, int(colorMixMode));"]))):(0,ie.H)(h||(h=(0,O.Z)(["\n                vec3 albedo = mixExternalColor(matColor, texColor.rgb, vcolorExt.rgb, int(colorMixMode));\n                float opacity_ = layerOpacity * mixExternalOpacity(opacity, texColor.a, vcolorExt.a, int(colorMixMode));"]))),e.hasNormalTexture?(0,ie.H)(g||(g=(0,O.Z)(["\n                mat3 tangentSpace = ","\n                vec3 shadingNormal = computeTextureNormal(tangentSpace, vuv0);"])),e.hasVertexTangents?"computeTangentSpace(normal);":"computeTangentSpace(normal, vpos, vuv0);"):(0,ie.H)(x||(x=(0,O.Z)(["vec3 shadingNormal = normal;"]))),e.spherical?(0,ie.H)(y||(y=(0,O.Z)(["normalize(vpos + localOrigin);"]))):(0,ie.H)(b||(b=(0,O.Z)(["vec3(0.0, 0.0, 1.0);"]))),e.snowCover?(0,ie.H)(C||(C=(0,O.Z)(["\n                float snow = smoothstep(0.5, 0.55, dot(normal, normalGround));\n                albedo = mix(albedo, vec3(1), snow);\n                shadingNormal = mix(shadingNormal, normal, snow);\n                ssao = mix(ssao, 1.0, snow);"]))):"",e.pbrMode===K.f7.Normal||e.pbrMode===K.f7.Schematic?(0,ie.H)(T||(T=(0,O.Z)(["\n                float additionalAmbientIrradiance = additionalAmbientIrradianceFactor * lightingMainIntensity[2];\n                ","\n\n                vec3 shadedColor = evaluateSceneLightingPBR(shadingNormal, albedo, shadow, 1.0 - ssao, additionalLight, shadingParams.viewDirection, normalGround, mrr, emission, additionalAmbientIrradiance);"])),e.snowCover?(0,ie.H)(w||(w=(0,O.Z)(["\n                        mrr = mix(mrr, vec3(0.0, 1.0, 0.04), snow);\n                        emission = mix(emission, vec3(0.0), snow);"]))):""):(0,ie.H)(M||(M=(0,O.Z)(["vec3 shadedColor = evaluateSceneLighting(shadingNormal, albedo, shadow, 1.0 - ssao, additionalLight);"]))),e.transparencyPassType===ue.Am.Color?(0,ie.H)(S||(S=(0,O.Z)(["gl_FragColor = premultiplyAlpha(gl_FragColor);"]))):""))),t.include(k.s,e),t}var ve=Object.freeze(Object.defineProperty({__proto__:null,build:me},Symbol.toStringTag,{value:"Module"}))},40563:function(e,t,n){n.d(t,{R:function(){return ue},b:function(){return ce}});var r,o,a,i,s,l,c,u,d,p,m,v,f,h,g,x,y,b,C,T,w,M,S,O,A,_=n(30168),H=n(22357),N=n(83734),P=n(71011),L=n(33280),Z=n(94951),R=n(81221),D=n(73782),E=n(52276),I=n(53230),B=n(60113),z=n(48655),F=n(49223),V=n(6781),k=n(30694),G=n(34975),q=n(15226),J=n(2116),W=n(41481),U=n(87920),j=n(18607),K=n(26461),X=n(65974),$=n(71033),Q=n(82552),Y=n(49450),ee=n(95276),te=n(58406),ne=n(98634),re=n(54118),oe=n(64201),ae=n(19253),ie=n(68401),se=n(4760),le=n(48919);function ce(e){var t=new oe.kG,n=t.vertex.code,ce=t.fragment.code,ue=(0,Q.S)(t,e);return t.include(E.f),t.varyings.add("vpos","vec3"),t.include(j.k,e),t.include(R.f,e),t.include(F.L,e),e.output!==P.H.Color&&e.output!==P.H.Alpha||((0,Q.h)(t.vertex,e),t.include(D.O,e),t.include(Z.w),e.offsetBackfaces&&t.include(N.w),e.instancedColor&&t.attributes.add(se.T.INSTANCECOLOR,"vec4"),t.varyings.add("vNormalWorld","vec3"),t.varyings.add("localvpos","vec3"),e.hasMultipassTerrain&&t.varyings.add("depth","float"),t.include(B.D,e),t.include(H.q,e),t.include(I.R,e),t.include(z.c,e),t.vertex.uniforms.add(new ee.N("externalColor",(function(e){return e.externalColor}))),t.varyings.add("vcolorExt","vec4"),n.add((0,ne.H)(r||(r=(0,_.Z)(["\n        void main(void) {\n          forwardNormalizedVertexColor();\n          vcolorExt = externalColor;\n          ","\n          vcolorExt *= vvColor();\n          vcolorExt *= getSymbolColor();\n          forwardColorMixMode();\n\n          if (vcolorExt.a < ",") {\n            gl_Position = vec4(1e38, 1e38, 1e38, 1.0);\n          } else {\n            vpos = calculateVPos();\n            localvpos = vpos - view[3].xyz;\n            vpos = subtractOrigin(vpos);\n            vNormalWorld = dpNormal(vvLocalNormal(normalModel()));\n            vpos = addVerticalOffset(vpos, localOrigin);\n            gl_Position = transformPosition(proj, view, vpos);\n            ","\n          }\n          ","\n          forwardLinearDepth();\n          forwardTextureCoordinates();\n        }\n      "])),e.instancedColor?"vcolorExt *= instanceColor;":"",ne.H.float(K.b),e.offsetBackfaces?"gl_Position = offsetBackfacingClipPosition(gl_Position, vpos, vNormalWorld, cameraPosition);":"",e.hasMultipassTerrain?(0,ne.H)(o||(o=(0,_.Z)(["depth = (view * vec4(vpos, 1.0)).z;"]))):""))),e.output===P.H.Alpha&&(t.include(L.f5,e),t.include(X.z,e),t.include(q.l,e),t.fragment.uniforms.add([new te.p("opacity",(function(e){return e.opacity})),new te.p("layerOpacity",(function(e){return e.layerOpacity})),new re.B("view")]),e.hasColorTexture&&t.fragment.uniforms.add(new ae.A("tex",(function(e){return e.texture}))),t.fragment.include($.y),ce.add((0,ne.H)(a||(a=(0,_.Z)(["\n      void main() {\n        discardBySlice(vpos);\n        ","\n        ","\n        ","\n\n        gl_FragColor = vec4(opacity_);\n      }\n    "])),e.hasMultipassTerrain?(0,ne.H)(i||(i=(0,_.Z)(["terrainDepthTest(gl_FragCoord, depth);"]))):"",e.hasColorTexture?(0,ne.H)(s||(s=(0,_.Z)(["\n                vec4 texColor = texture2D(tex, vuv0);\n                ","\n                discardOrAdjustAlpha(texColor);"])),e.textureAlphaPremultiplied?"texColor.rgb /= texColor.a;":""):(0,ne.H)(l||(l=(0,_.Z)(["vec4 texColor = vec4(1.0);"]))),e.hasVertexColors?(0,ne.H)(c||(c=(0,_.Z)(["float opacity_ = layerOpacity * mixExternalOpacity(vColor.a * opacity, texColor.a, vcolorExt.a, int(colorMixMode));"]))):(0,ne.H)(u||(u=(0,_.Z)(["float opacity_ = layerOpacity * mixExternalOpacity(opacity, texColor.a, vcolorExt.a, int(colorMixMode));"])))))),e.output===P.H.Color&&(t.include(L.f5,e),t.include(G.X,e),t.include(k.K,e),t.include(X.z,e),t.include(e.instancedDoublePrecision?U.hb:U.XE,e),t.include(q.l,e),(0,Q.h)(t.fragment,e),t.fragment.uniforms.add([ue,new Y.J("ambient",(function(e){return e.ambient})),new Y.J("diffuse",(function(e){return e.diffuse})),new te.p("opacity",(function(e){return e.opacity})),new te.p("layerOpacity",(function(e){return e.layerOpacity})),new re.B("view"),new te.p("lightingGlobalFactor",(function(e,t){return t.lighting.globalFactor})),new Y.J("lightingMainIntensity",(function(e,t){return t.lighting.mainLight.intensity}))]),t.fragment.constants.add("ambientBoostFactor","float",le.V),e.hasColorTexture&&t.fragment.uniforms.add(new ae.A("tex",(function(e){return e.texture}))),t.include(W.jV,e),t.include(J.T,e),t.fragment.include($.y),t.extensions.add("GL_OES_standard_derivatives"),ce.add((0,ne.H)(d||(d=(0,_.Z)(["\n      void main() {\n        discardBySlice(vpos);\n        ","\n        ","\n        vec3 viewDirection = normalize(vpos - cameraPosition);\n        ","\n        float ssao = evaluateAmbientOcclusionInverse();\n        ssao *= getBakedOcclusion();\n\n        float additionalAmbientScale = additionalDirectedAmbientLight(vpos + localOrigin);\n        vec3 additionalLight = ssao * lightingMainIntensity * additionalAmbientScale * ambientBoostFactor * lightingGlobalFactor;\n        ","\n        vec3 matColor = max(ambient, diffuse);\n        ","\n        ","\n        ","\n        ","\n        ","\n        gl_FragColor = highlightSlice(vec4(shadedColor, opacity_), vpos);\n        ","\n      }\n    "])),e.hasMultipassTerrain?(0,ne.H)(p||(p=(0,_.Z)(["terrainDepthTest(gl_FragCoord, depth);"]))):"",e.hasColorTexture?(0,ne.H)(m||(m=(0,_.Z)(["\n                vec4 texColor = texture2D(tex, vuv0);\n                ","\n                discardOrAdjustAlpha(texColor);"])),e.textureAlphaPremultiplied?"texColor.rgb /= texColor.a;":""):(0,ne.H)(v||(v=(0,_.Z)(["vec4 texColor = vec4(1.0);"]))),e.pbrMode===W.f7.Normal?"applyPBRFactors();":"",e.receiveShadows?"float shadow = readShadowMap(vpos, linearDepth);":e.spherical?"float shadow = lightingGlobalFactor * (1.0 - additionalAmbientScale);":"float shadow = 0.0;",e.hasVertexColors?(0,ne.H)(f||(f=(0,_.Z)(["\n                vec3 albedo = mixExternalColor(vColor.rgb * matColor, texColor.rgb, vcolorExt.rgb, int(colorMixMode));\n                float opacity_ = layerOpacity * mixExternalOpacity(vColor.a * opacity, texColor.a, vcolorExt.a, int(colorMixMode));"]))):(0,ne.H)(h||(h=(0,_.Z)(["\n                vec3 albedo = mixExternalColor(matColor, texColor.rgb, vcolorExt.rgb, int(colorMixMode));\n                float opacity_ = layerOpacity * mixExternalOpacity(opacity, texColor.a, vcolorExt.a, int(colorMixMode));"]))),e.snowCover?(0,ne.H)(g||(g=(0,_.Z)(["albedo = mix(albedo, vec3(1), 0.9);"]))):(0,ne.H)(x||(x=(0,_.Z)([""]))),(0,ne.H)(y||(y=(0,_.Z)(["\n            vec3 shadingNormal = normalize(vNormalWorld);\n            albedo *= 1.2;\n            vec3 viewForward = vec3(view[0][2], view[1][2], view[2][2]);\n            float alignmentLightView = clamp(dot(viewForward, -lightingMainDirection), 0.0, 1.0);\n            float transmittance = 1.0 - clamp(dot(viewForward, shadingNormal), 0.0, 1.0);\n            float treeRadialFalloff = vColor.r;\n            float backLightFactor = 0.5 * treeRadialFalloff * alignmentLightView * transmittance * (1.0 - shadow);\n            additionalLight += backLightFactor * lightingMainIntensity;"]))),e.pbrMode===W.f7.Normal||e.pbrMode===W.f7.Schematic?e.spherical?(0,ne.H)(b||(b=(0,_.Z)(["vec3 normalGround = normalize(vpos + localOrigin);"]))):(0,ne.H)(C||(C=(0,_.Z)(["vec3 normalGround = vec3(0.0, 0.0, 1.0);"]))):(0,ne.H)(T||(T=(0,_.Z)([""]))),e.pbrMode===W.f7.Normal||e.pbrMode===W.f7.Schematic?(0,ne.H)(w||(w=(0,_.Z)(["\n                float additionalAmbientIrradiance = additionalAmbientIrradianceFactor * lightingMainIntensity[2];\n                ","\n\n                vec3 shadedColor = evaluateSceneLightingPBR(shadingNormal, albedo, shadow, 1.0 - ssao, additionalLight, viewDirection, normalGround, mrr, emission, additionalAmbientIrradiance);"])),e.snowCover?(0,ne.H)(M||(M=(0,_.Z)(["\n                        mrr = vec3(0.0, 1.0, 0.04);\n                        emission = vec3(0.0);"]))):""):(0,ne.H)(S||(S=(0,_.Z)(["vec3 shadedColor = evaluateSceneLighting(shadingNormal, albedo, shadow, 1.0 - ssao, additionalLight);"]))),e.transparencyPassType===ie.Am.Color?(0,ne.H)(O||(O=(0,_.Z)(["gl_FragColor = premultiplyAlpha(gl_FragColor);"]))):(0,ne.H)(A||(A=(0,_.Z)([""])))))),t.include(V.s,e),t}var ue=Object.freeze(Object.defineProperty({__proto__:null,build:ce},Symbol.toStringTag,{value:"Module"}))},32035:function(e,t,n){n.d(t,{a:function(){return a},b:function(){return l},n:function(){return s},s:function(){return i},t:function(){return o}});var r=n(77873);function o(e,t,n){if(e.count===t.count)for(var o=e.count,a=n[0],i=n[1],s=n[2],l=n[4],c=n[5],u=n[6],d=n[8],p=n[9],m=n[10],v=n[12],f=n[13],h=n[14],g=e.typedBuffer,x=e.typedBufferStride,y=t.typedBuffer,b=t.typedBufferStride,C=0;C<o;C++){var T=C*x,w=C*b,M=y[w],S=y[w+1],O=y[w+2];g[T]=a*M+l*S+d*O+v,g[T+1]=i*M+c*S+p*O+f,g[T+2]=s*M+u*S+m*O+h}else r.c.error("source and destination buffers need to have the same number of elements")}function a(e,t,n){if(e.count===t.count)for(var o=e.count,a=n[0],i=n[1],s=n[2],l=n[3],c=n[4],u=n[5],d=n[6],p=n[7],m=n[8],v=e.typedBuffer,f=e.typedBufferStride,h=t.typedBuffer,g=t.typedBufferStride,x=0;x<o;x++){var y=x*f,b=x*g,C=h[b],T=h[b+1],w=h[b+2];v[y]=a*C+l*T+d*w,v[y+1]=i*C+c*T+p*w,v[y+2]=s*C+u*T+m*w}else r.c.error("source and destination buffers need to have the same number of elements")}function i(e,t,n){for(var r=Math.min(e.count,t.count),o=e.typedBuffer,a=e.typedBufferStride,i=t.typedBuffer,s=t.typedBufferStride,l=0;l<r;l++){var c=l*a,u=l*s;o[c]=n*i[u],o[c+1]=n*i[u+1],o[c+2]=n*i[u+2]}}function s(e,t){for(var n=Math.min(e.count,t.count),r=e.typedBuffer,o=e.typedBufferStride,a=t.typedBuffer,i=t.typedBufferStride,s=0;s<n;s++){var l=s*o,c=s*i,u=a[c],d=a[c+1],p=a[c+2],m=u*u+d*d+p*p;if(m>0){var v=1/Math.sqrt(m);r[l]=v*u,r[l+1]=v*d,r[l+2]=v*p}}}function l(e,t,n){for(var r=Math.min(e.count,t.count),o=e.typedBuffer,a=e.typedBufferStride,i=t.typedBuffer,s=t.typedBufferStride,l=0;l<r;l++){var c=l*a,u=l*s;o[c]=i[u]>>n,o[c+1]=i[u+1]>>n,o[c+2]=i[u+2]>>n}}Object.freeze(Object.defineProperty({__proto__:null,transformMat4:o,transformMat3:a,scale:i,normalize:s,shiftRight:l},Symbol.toStringTag,{value:"Module"}))},92770:function(e,t,n){function r(e,t,n){for(var r=e.typedBuffer,o=e.typedBufferStride,a=t.typedBuffer,i=t.typedBufferStride,s=n?n.count:t.count,l=(n&&n.dstIndex?n.dstIndex:0)*o,c=(n&&n.srcIndex?n.srcIndex:0)*i,u=0;u<s;++u)r[l]=a[c],r[l+1]=a[c+1],r[l+2]=a[c+2],l+=o,c+=i}function o(e,t,n,r,o){for(var a,i,s=e.typedBuffer,l=e.typedBufferStride,c=null!==(a=null===o||void 0===o?void 0:o.count)&&void 0!==a?a:e.count,u=(null!==(i=null===o||void 0===o?void 0:o.dstIndex)&&void 0!==i?i:0)*l,d=0;d<c;++d)s[u]=t,s[u+1]=n,s[u+2]=r,u+=l}n.d(t,{c:function(){return r},f:function(){return o}});Object.freeze(Object.defineProperty({__proto__:null,copy:r,fill:o},Symbol.toStringTag,{value:"Module"}))},71277:function(e,t,n){function r(e){return e=e||globalThis.location.hostname,c.some((function(t){var n;return null!=(null===(n=e)||void 0===n?void 0:n.match(t))}))}function o(e,t){return e&&(t=t||globalThis.location.hostname)?null!=t.match(a)||null!=t.match(s)?e.replace("static.arcgis.com","staticdev.arcgis.com"):null!=t.match(i)||null!=t.match(l)?e.replace("static.arcgis.com","staticqa.arcgis.com"):e:e}n.d(t,{XO:function(){return r},pJ:function(){return o}});var a=/^devext.arcgis.com$/,i=/^qaext.arcgis.com$/,s=/^[\w-]*\.mapsdevext.arcgis.com$/,l=/^[\w-]*\.mapsqa.arcgis.com$/,c=[/^([\w-]*\.)?[\w-]*\.zrh-dev-local.esri.com$/,a,i,/^jsapps.esri.com$/,s,l]},77873:function(e,t,n){n.d(t,{c:function(){return r}});var r=n(32718).Z.getLogger("esri.views.3d.support.buffer.math")},4265:function(e,t,n){n.r(t),n.d(t,{fetch:function(){return ne},gltfToEngineResources:function(){return ae},parseUrl:function(){return oe}});var r=n(74165),o=n(37762),a=n(1413),i=n(15861),s=n(71277),l=n(92026),c=n(22753),u=n(11873),d=n(14226),p=n(81949),m=n(11186),v=n(71353),f=n(41414),h=n(25158),g=n(32035),x=n(19093),y=n(17054),b=n(27053),C=n(55798),T=n(32315),w=n(76200),M=n(14921),S=n(10064),O=n(32718),A=n(66978),_=n(49901),H=n(38330),N=n(68401),P=n(74894),L=n(76873),Z=n(86802),R=n(8548),D=O.Z.getLogger("esri.views.3d.layers.graphics.objectResourceUtils");function E(e,t){return I.apply(this,arguments)}function I(){return(I=(0,i.Z)((0,r.Z)().mark((function e(t,n){var o;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,B(t,n);case 2:return o=e.sent,e.t0=o,e.next=6,W(o.textureDefinitions,n);case 6:return e.t1=e.sent,e.abrupt("return",{resource:e.t0,textures:e.t1});case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function B(e,t){return z.apply(this,arguments)}function z(){return(z=(0,i.Z)((0,r.Z)().mark((function e(t,n){var o,a;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(o=(0,l.pC)(n)&&n.streamDataRequester)){e.next=3;break}return e.abrupt("return",F(t,o,n));case 3:return e.next=5,(0,M.q6)((0,w.default)(t,(0,l.Wg)(n)));case 5:if(!0!==(a=e.sent).ok){e.next=8;break}return e.abrupt("return",a.value.data);case 8:(0,A.r9)(a.error),k(a.error);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function F(e,t,n){return V.apply(this,arguments)}function V(){return(V=(0,i.Z)((0,r.Z)().mark((function e(t,n,o){var a;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,M.q6)(n.request(t,"json",o));case 2:if(!0!==(a=e.sent).ok){e.next=5;break}return e.abrupt("return",a.value);case 5:(0,A.r9)(a.error),k(a.error.details.url);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function k(e){throw new S.Z("","Request for object resource failed: ".concat(e))}function G(e){var t=e.params,n=t.topology,r=!0;switch(t.vertexAttributes||(D.warn("Geometry must specify vertex attributes"),r=!1),t.topology){case"PerAttributeArray":break;case"Indexed":case null:case void 0:var o=t.faces;if(o){if(t.vertexAttributes)for(var a in t.vertexAttributes){var i=o[a];i&&i.values?(null!=i.valueType&&"UInt32"!==i.valueType&&(D.warn("Unsupported indexed geometry indices type '".concat(i.valueType,"', only UInt32 is currently supported")),r=!1),null!=i.valuesPerElement&&1!==i.valuesPerElement&&(D.warn("Unsupported indexed geometry values per element '".concat(i.valuesPerElement,"', only 1 is currently supported")),r=!1)):(D.warn("Indexed geometry does not specify face indices for '".concat(a,"' attribute")),r=!1)}}else D.warn("Indexed geometries must specify faces"),r=!1;break;default:D.warn("Unsupported topology '".concat(n,"'")),r=!1}e.params.material||(D.warn("Geometry requires material"),r=!1);var s=e.params.vertexAttributes;for(var l in s)s[l].values||(D.warn("Geometries with externally defined attributes are not yet supported"),r=!1);return r}function q(e,t){var n=[],r=[],o=[],a=[],i=e.resource,s=_.G.parse(i.version||"1.0","wosr");X.validate(s);for(var c=i.model.name,u=i.model.geometries,d=i.materialDefinitions,p=e.textures,m=0,f=new Map,h=0;h<u.length;h++){var g=u[h];if(G(g)){var x=K(g),y=g.params.vertexAttributes,b=[];for(var C in y){var T=y[C],w=T.values;b.push([C,{data:w,size:T.valuesPerElement,exclusive:!0}])}var M=[];if("PerAttributeArray"!==g.params.topology){var S=g.params.faces;for(var O in S)M.push([O,new Uint32Array(S[O].values)])}var A=p&&p[x.texture];if(A&&!f.has(x.texture)){var H=A.image,R=A.params,D=new L.x(H,R);a.push(D),f.set(x.texture,D)}var E=f.get(x.texture),I=E?E.id:void 0,B=o[x.material]?o[x.material][x.texture]:null;if(!B){var z=d[x.material.substring(x.material.lastIndexOf("/")+1)].params;1===z.transparency&&(z.transparency=0);var F=A&&A.alphaChannelUsage,V=z.transparency>0||"transparency"===F||"maskAndTransparency"===F,k=A?j(A.alphaChannelUsage):void 0,q={ambient:(0,v.d)(z.diffuse),diffuse:(0,v.d)(z.diffuse),opacity:1-(z.transparency||0),transparent:V,textureAlphaMode:k,textureAlphaCutoff:.33,textureId:I,initTextureTransparent:!0,doubleSided:!0,cullFace:N.Vr.None,colorMixMode:z.externalColorMixMode||"tint",textureAlphaPremultiplied:!!A&&!!A.params.preMultiplyAlpha};(0,l.pC)(t)&&t.materialParamsMixin&&Object.assign(q,t.materialParamsMixin),B=new Z.Gp(q),o[x.material]||(o[x.material]={}),o[x.material][x.texture]=B}r.push(B);var W=new P.Z(b,M);m+=M.position?M.position.length:0,n.push(W)}}return{name:c,stageResources:{textures:a,materials:r,geometries:n},pivotOffset:i.model.pivotOffset,boundingBox:J(n),numberOfVertices:m,lodThreshold:null}}function J(e){var t=(0,f.cS)();return e.forEach((function(e){var n=e.boundingInfo;(0,l.pC)(n)&&((0,f.pp)(t,n.getBBMin()),(0,f.pp)(t,n.getBBMax()))})),t}function W(e,t){return U.apply(this,arguments)}function U(){return(U=(0,i.Z)((0,r.Z)().mark((function e(t,n){var a,i,s,c,u,d,p,m;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=[],i=function(e){var r=t[e],o=r.images[0].data;if(!o)return D.warn("Externally referenced texture data is not yet supported"),"continue";var i=r.encoding+";base64,"+o,s="/textureDefinitions/"+e,c="rgba"===r.channels?r.alphaChannelUsage||"transparency":"none",u={noUnpackFlip:!0,wrap:{s:R.e8.REPEAT,t:R.e8.REPEAT},preMultiplyAlpha:j(c)!==N.JJ.Opaque},d=(0,l.pC)(n)&&n.disableTextures?Promise.resolve(null):(0,H.t)(i,n);a.push(d.then((function(e){return{refId:s,image:e,params:u,alphaChannelUsage:c}})))},e.t0=(0,r.Z)().keys(t);case 3:if((e.t1=e.t0()).done){e.next=10;break}if(s=e.t1.value,"continue"!==i(s)){e.next=8;break}return e.abrupt("continue",3);case 8:e.next=3;break;case 10:return e.next=12,Promise.all(a);case 12:c=e.sent,u={},d=(0,o.Z)(c);try{for(d.s();!(p=d.n()).done;)m=p.value,u[m.refId]=m}catch(v){d.e(v)}finally{d.f()}return e.abrupt("return",u);case 17:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function j(e){switch(e){case"mask":return N.JJ.Mask;case"maskAndTransparency":return N.JJ.MaskBlend;case"none":return N.JJ.Opaque;default:return N.JJ.Blend}}function K(e){var t=e.params;return{id:1,material:t.material,texture:t.texture,region:t.texture}}var X=new _.G(1,2,"wosr"),$=n(4760),Q=n(68845),Y=n(19131),ee=n(69618),te=n(92770);function ne(e,t){return re.apply(this,arguments)}function re(){return(re=(0,i.Z)((0,r.Z)().mark((function e(t,n){var o,i,c,u,d,p,m,v,f,h;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("wosr"!==(o=oe((0,s.pJ)(t))).fileType){e.next=7;break}return e.next=4,n.cache?n.cache.loadWOSR(o.url,n):E(o.url,n);case 4:return i=e.sent,c=q(i,n),e.abrupt("return",{lods:[c],referenceBoundingBox:c.boundingBox,isEsriSymbolResource:!1,isWosr:!0,remove:i.remove});case 7:return e.next=9,n.cache?n.cache.loadGLTF(o.url,n,n.usePBR):(0,C.z)(new b.C(n.streamDataRequester),o.url,n,n.usePBR);case 9:if(u=e.sent,d=(0,l.U2)(u.model.meta,"ESRI_proxyEllipsoid"),u.meta.isEsriSymbolResource&&(0,l.pC)(d)&&u.meta.uri.includes("/RealisticTrees/")&&ie(u,d),p=u.meta.isEsriSymbolResource?{usePBR:n.usePBR,isSchematic:!1,treeRendering:!!u.customMeta.esriTreeRendering,mrrFactors:[0,1,.2]}:{usePBR:n.usePBR,isSchematic:!1,treeRendering:!1,mrrFactors:[0,1,.5]},m=(0,a.Z)((0,a.Z)({},n.materialParamsMixin),{},{treeRendering:!!u.customMeta.esriTreeRendering}),null==o.specifiedLodIndex){e.next=18;break}return v=ae(u,p,m,o.specifiedLodIndex),f=v[0].boundingBox,0!==o.specifiedLodIndex&&(f=ae(u,p,m,0)[0].boundingBox),e.abrupt("return",{lods:v,referenceBoundingBox:f,isEsriSymbolResource:u.meta.isEsriSymbolResource,isWosr:!1,remove:u.remove});case 18:return h=ae(u,p,m),e.abrupt("return",{lods:h,referenceBoundingBox:h[0].boundingBox,isEsriSymbolResource:u.meta.isEsriSymbolResource,isWosr:!1,remove:u.remove});case 20:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function oe(e){var t=e.match(/(.*\.(gltf|glb))(\?lod=([0-9]+))?$/);return t?{fileType:"gltf",url:t[1],specifiedLodIndex:null!=t[4]?Number(t[4]):null}:e.match(/(.*\.(json|json\.gz))$/)?{fileType:"wosr",url:e,specifiedLodIndex:null}:{fileType:"unknown",url:e,specifiedLodIndex:null}}function ae(e,t,n,r){var o=e.model,i=(0,u.c)(),s=new Array,d=new Map,p=new Map;return o.lods.forEach((function(e,u){if(void 0===r||u===r){var m={name:e.name,stageResources:{textures:new Array,materials:new Array,geometries:new Array},lodThreshold:(0,l.pC)(e.lodThreshold)?e.lodThreshold:null,pivotOffset:[0,0,0],numberOfVertices:0,boundingBox:(0,f.cS)()};s.push(m),e.parts.forEach((function(e){var r=e.material+(e.attributes.normal?"_normal":"")+(e.attributes.color?"_color":"")+(e.attributes.texCoord0?"_texCoord0":"")+(e.attributes.tangent?"_tangent":""),s=o.materials.get(e.material),u=(0,l.pC)(e.attributes.texCoord0),v=(0,l.pC)(e.attributes.normal),b=function(e){switch(e){case"BLEND":return N.JJ.Blend;case"MASK":return N.JJ.Mask;case"OPAQUE":case null:case void 0:return N.JJ.Opaque}}(s.alphaMode);if(!d.has(r)){if(u){if((0,l.pC)(s.textureColor)&&!p.has(s.textureColor)){var C=o.textures.get(s.textureColor),w=(0,a.Z)((0,a.Z)({},C.parameters),{},{preMultiplyAlpha:b!==N.JJ.Opaque});p.set(s.textureColor,new L.x(C.data,w))}if((0,l.pC)(s.textureNormal)&&!p.has(s.textureNormal)){var M=o.textures.get(s.textureNormal);p.set(s.textureNormal,new L.x(M.data,M.parameters))}if((0,l.pC)(s.textureOcclusion)&&!p.has(s.textureOcclusion)){var S=o.textures.get(s.textureOcclusion);p.set(s.textureOcclusion,new L.x(S.data,S.parameters))}if((0,l.pC)(s.textureEmissive)&&!p.has(s.textureEmissive)){var O=o.textures.get(s.textureEmissive);p.set(s.textureEmissive,new L.x(O.data,O.parameters))}if((0,l.pC)(s.textureMetallicRoughness)&&!p.has(s.textureMetallicRoughness)){var A=o.textures.get(s.textureMetallicRoughness);p.set(s.textureMetallicRoughness,new L.x(A.data,A.parameters))}}var _=Math.pow(s.color[0],1/Q.K),H=Math.pow(s.color[1],1/Q.K),D=Math.pow(s.color[2],1/Q.K),E=Math.pow(s.emissiveFactor[0],1/Q.K),I=Math.pow(s.emissiveFactor[1],1/Q.K),B=Math.pow(s.emissiveFactor[2],1/Q.K),z=(0,l.pC)(s.textureColor)&&u?p.get(s.textureColor):null;d.set(r,new Z.Gp((0,a.Z)((0,a.Z)({},t),{},{transparent:b===N.JJ.Blend,customDepthTest:N.Gv.Lequal,textureAlphaMode:b,textureAlphaCutoff:s.alphaCutoff,diffuse:[_,H,D],ambient:[_,H,D],opacity:s.opacity,doubleSided:s.doubleSided,doubleSidedType:"winding-order",cullFace:s.doubleSided?N.Vr.None:N.Vr.Back,hasVertexColors:!!e.attributes.color,hasVertexTangents:!!e.attributes.tangent,normals:v?"default":"screenDerivative",castShadows:!0,receiveSSAO:!0,textureId:(0,l.pC)(z)?z.id:void 0,colorMixMode:s.colorMixMode,normalTextureId:(0,l.pC)(s.textureNormal)&&u?p.get(s.textureNormal).id:void 0,textureAlphaPremultiplied:(0,l.pC)(z)&&!!z.params.preMultiplyAlpha,occlusionTextureId:(0,l.pC)(s.textureOcclusion)&&u?p.get(s.textureOcclusion).id:void 0,emissiveTextureId:(0,l.pC)(s.textureEmissive)&&u?p.get(s.textureEmissive).id:void 0,metallicRoughnessTextureId:(0,l.pC)(s.textureMetallicRoughness)&&u?p.get(s.textureMetallicRoughness).id:void 0,emissiveFactor:[E,I,B],mrrFactors:[s.metallicFactor,s.roughnessFactor,t.mrrFactors[2]],isSchematic:!1},n)))}var F=function(e,t){switch(t){case R.MX.TRIANGLES:return(0,T.nh)(e);case R.MX.TRIANGLE_STRIP:return(0,T.DA)(e);case R.MX.TRIANGLE_FAN:return(0,T.jX)(e)}}(e.indices||e.attributes.position.count,e.primitiveType),V=e.attributes.position.count,k=(0,y.gS)(h.ct,V);(0,g.t)(k,e.attributes.position,e.transform);var G=[[$.T.POSITION,{data:k.typedBuffer,size:k.elementCount,exclusive:!0}]],q=[[$.T.POSITION,F]];if((0,l.pC)(e.attributes.normal)){var J=(0,y.gS)(h.ct,V);(0,c.a)(i,e.transform),(0,g.a)(J,e.attributes.normal,i),G.push([$.T.NORMAL,{data:J.typedBuffer,size:J.elementCount,exclusive:!0}]),q.push([$.T.NORMAL,F])}if((0,l.pC)(e.attributes.tangent)){var W=(0,y.gS)(h.ek,V);(0,c.a)(i,e.transform),(0,x.t)(W,e.attributes.tangent,i),G.push([$.T.TANGENT,{data:W.typedBuffer,size:W.elementCount,exclusive:!0}]),q.push([$.T.TANGENT,F])}if((0,l.pC)(e.attributes.texCoord0)){var U=(0,y.gS)(h.Eu,V);(0,Y.n)(U,e.attributes.texCoord0),G.push([$.T.UV0,{data:U.typedBuffer,size:U.elementCount,exclusive:!0}]),q.push([$.T.UV0,F])}if((0,l.pC)(e.attributes.color)){var j=(0,y.gS)(h.mc,V);if(4===e.attributes.color.elementCount)e.attributes.color instanceof h.ek?(0,x.s)(j,e.attributes.color,255):e.attributes.color instanceof h.mc?(0,ee.c)(j,e.attributes.color):e.attributes.color instanceof h.v6&&(0,x.s)(j,e.attributes.color,1/256);else{(0,ee.f)(j,255,255,255,255);var K=new h.ne(j.buffer,0,4);e.attributes.color instanceof h.ct?(0,g.s)(K,e.attributes.color,255):e.attributes.color instanceof h.ne?(0,te.c)(K,e.attributes.color):e.attributes.color instanceof h.mw&&(0,g.s)(K,e.attributes.color,1/256)}G.push([$.T.COLOR,{data:j.typedBuffer,size:j.elementCount,exclusive:!0}]),q.push([$.T.COLOR,F])}var X=new P.Z(G,q);m.stageResources.geometries.push(X),m.stageResources.materials.push(d.get(r)),u&&((0,l.pC)(s.textureColor)&&m.stageResources.textures.push(p.get(s.textureColor)),(0,l.pC)(s.textureNormal)&&m.stageResources.textures.push(p.get(s.textureNormal)),(0,l.pC)(s.textureOcclusion)&&m.stageResources.textures.push(p.get(s.textureOcclusion)),(0,l.pC)(s.textureEmissive)&&m.stageResources.textures.push(p.get(s.textureEmissive)),(0,l.pC)(s.textureMetallicRoughness)&&m.stageResources.textures.push(p.get(s.textureMetallicRoughness))),m.numberOfVertices+=V;var ne=X.boundingInfo;(0,l.pC)(ne)&&((0,f.pp)(m.boundingBox,ne.getBBMin()),(0,f.pp)(m.boundingBox,ne.getBBMax()))}))}})),s}function ie(e,t){for(var n=0;n<e.model.lods.length;++n){var r=e.model.lods[n];e.customMeta.esriTreeRendering=!0;var a,i=(0,o.Z)(r.parts);try{for(i.s();!(a=i.n()).done;){var s=a.value,c=s.attributes.normal;if((0,l.Wi)(c))return;for(var u=s.attributes.position,f=u.count,g=(0,v.c)(),x=(0,v.c)(),b=(0,v.c)(),C=(0,y.gS)(h.mc,f),T=(0,y.gS)(h.ct,f),w=(0,d.a)((0,p.c)(),s.transform),M=0;M<f;M++){u.getVec(M,x),c.getVec(M,g),(0,m.m)(x,x,s.transform),(0,m.b)(b,x,t.center),(0,m.G)(b,b,t.radius);var S=b[2],O=(0,m.l)(b),A=Math.min(.45+.55*O*O,1);(0,m.G)(b,b,t.radius),(0,m.m)(b,b,w),(0,m.n)(b,b),n+1!==e.model.lods.length&&e.model.lods.length>1&&(0,m.h)(b,b,g,S>-1?.2:Math.min(-4*S-3.8,1)),T.setVec(M,b),C.set(M,0,255*A),C.set(M,1,255*A),C.set(M,2,255*A),C.set(M,3,255)}s.attributes.normal=T,s.attributes.color=C}}catch(_){i.e(_)}finally{i.f()}}}},49420:function(e,t,n){n.d(t,{F5:function(){return s},HB:function(){return l},a9:function(){return r}});var r,o,a=n(16889),i=n(92026);function s(e){switch(e){case"multiply":default:return r.Multiply;case"ignore":return r.Ignore;case"replace":return r.Replace;case"tint":return r.Tint}}function l(e,t,n){if((0,i.Wi)(e)||t===r.Ignore)return n[0]=255,n[1]=255,n[2]=255,void(n[3]=255);var o=(0,a.uZ)(Math.round(e[3]*u),0,u),s=0===o||t===r.Tint?0:t===r.Replace?d:p;n[0]=(0,a.uZ)(Math.round(e[0]*c),0,c),n[1]=(0,a.uZ)(Math.round(e[1]*c),0,c),n[2]=(0,a.uZ)(Math.round(e[2]*c),0,c),n[3]=o+s}(o=r||(r={}))[o.Multiply=1]="Multiply",o[o.Ignore=2]="Ignore",o[o.Replace=3]="Replace",o[o.Tint=4]="Tint";var c=255,u=85,d=u,p=2*u},83734:function(e,t,n){n.d(t,{w:function(){return i}});var r,o=n(30168),a=n(98634);function i(e){e.vertex.code.add((0,a.H)(r||(r=(0,o.Z)(["vec4 offsetBackfacingClipPosition(vec4 posClip, vec3 posWorld, vec3 normalWorld, vec3 camPosWorld) {\nvec3 camToVert = posWorld - camPosWorld;\nbool isBackface = dot(camToVert, normalWorld) > 0.0;\nif (isBackface) {\nposClip.z += 0.0000003 * posClip.w;\n}\nreturn posClip;\n}"]))))}},81221:function(e,t,n){n.d(t,{f:function(){return y}});var r,o,a,i,s,l,c=n(30168),u=n(11186),d=n(71353),p=n(71011),m=n(27254),v=n(86471),f=n(98634),h=n(8654),g=n(4760),x=n(43411);function y(e,t){t.instanced&&t.instancedDoublePrecision&&(e.attributes.add(g.T.MODELORIGINHI,"vec3"),e.attributes.add(g.T.MODELORIGINLO,"vec3"),e.attributes.add(g.T.MODEL,"mat3"),e.attributes.add(g.T.MODELNORMAL,"mat3"));var n=e.vertex;t.instancedDoublePrecision&&(n.include(m.$,t),n.uniforms.add(new v.B("viewOriginHi",(function(e,t){return(0,x.U8)((0,u.s)(b,t.camera.viewInverseTransposeMatrix[3],t.camera.viewInverseTransposeMatrix[7],t.camera.viewInverseTransposeMatrix[11]),b)}))),n.uniforms.add(new v.B("viewOriginLo",(function(e,t){return(0,x.GB)((0,u.s)(b,t.camera.viewInverseTransposeMatrix[3],t.camera.viewInverseTransposeMatrix[7],t.camera.viewInverseTransposeMatrix[11]),b)})))),n.code.add((0,f.H)(r||(r=(0,c.Z)(["\n    vec3 calculateVPos() {\n      ","\n    }\n    "])),t.instancedDoublePrecision?"return model * localPosition().xyz;":"return localPosition().xyz;")),n.code.add((0,f.H)(o||(o=(0,c.Z)(["\n    vec3 subtractOrigin(vec3 _pos) {\n      ","\n    }\n    "])),t.instancedDoublePrecision?(0,f.H)(a||(a=(0,c.Z)(["\n          vec3 originDelta = dpAdd(viewOriginHi, viewOriginLo, -modelOriginHi, -modelOriginLo);\n          return _pos - originDelta;"]))):"return vpos;")),n.code.add((0,f.H)(i||(i=(0,c.Z)(["\n    vec3 dpNormal(vec4 _normal) {\n      ","\n    }\n    "])),t.instancedDoublePrecision?"return normalize(modelNormal * _normal.xyz);":"return normalize(_normal.xyz);")),t.output===p.H.Normal&&(n.uniforms.add(new h.g("viewNormal",(function(e,t){return t.camera.viewInverseTransposeMatrix}))),n.code.add((0,f.H)(s||(s=(0,c.Z)(["\n    vec3 dpNormalView(vec4 _normal) {\n      ","\n    }\n    "])),t.instancedDoublePrecision?"return normalize((viewNormal * vec4(modelNormal * _normal.xyz, 1.0)).xyz);":"return normalize((viewNormal * _normal).xyz);"))),t.hasVertexTangents&&n.code.add((0,f.H)(l||(l=(0,c.Z)(["\n    vec4 dpTransformVertexTangent(vec4 _tangent) {\n      ","\n\n    }\n    "])),t.instancedDoublePrecision?"return vec4(modelNormal * _tangent.xyz, _tangent.w);":"return _tangent;"))}var b=(0,d.c)()},53230:function(e,t,n){n.d(t,{R:function(){return m}});var r,o=n(30168),a=n(49420),i=n(98634);function s(e){e.vertex.code.add((0,i.H)(r||(r=(0,o.Z)(["\n    vec4 decodeSymbolColor(vec4 symbolColor, out int colorMixMode) {\n      float symbolAlpha = 0.0;\n\n      const float maxTint = 85.0;\n      const float maxReplace = 170.0;\n      const float scaleAlpha = 3.0;\n\n      if (symbolColor.a > maxReplace) {\n        colorMixMode = ",";\n        symbolAlpha = scaleAlpha * (symbolColor.a - maxReplace);\n      } else if (symbolColor.a > maxTint) {\n        colorMixMode = ",";\n        symbolAlpha = scaleAlpha * (symbolColor.a - maxTint);\n      } else if (symbolColor.a > 0.0) {\n        colorMixMode = ",";\n        symbolAlpha = scaleAlpha * symbolColor.a;\n      } else {\n        colorMixMode = ",";\n        symbolAlpha = 0.0;\n      }\n\n      return vec4(symbolColor.r, symbolColor.g, symbolColor.b, symbolAlpha);\n    }\n  "])),i.H.int(a.a9.Multiply),i.H.int(a.a9.Replace),i.H.int(a.a9.Tint),i.H.int(a.a9.Multiply)))}var l,c,u=n(99339),d=n(4760),p=n(22909);function m(e,t){t.hasSymbolColors?(e.include(s),e.attributes.add(d.T.SYMBOLCOLOR,"vec4"),e.varyings.add("colorMixMode","mediump float"),e.vertex.code.add((0,i.H)(l||(l=(0,o.Z)(["int symbolColorMixMode;\nvec4 getSymbolColor() {\nreturn decodeSymbolColor(symbolColor, symbolColorMixMode) * 0.003921568627451;\n}\nvoid forwardColorMixMode() {\ncolorMixMode = float(symbolColorMixMode) + 0.5;\n}"]))))):(e.fragment.uniforms.add(new u._("colorMixMode",(function(e){return p.FZ[e.colorMixMode]}))),e.vertex.code.add((0,i.H)(c||(c=(0,o.Z)(["vec4 getSymbolColor() { return vec4(1.0); }\nvoid forwardColorMixMode() {}"])))))}},6781:function(e,t,n){n.d(t,{s:function(){return N}});var r,o,a,i,s,l,c,u,d,p,m,v,f=n(30168),h=n(71011),g=n(33280),x=n(94951),y=n(73782),b=n(60113),C=n(85380),T=n(16574),w=n(137),M=n(18607),S=n(65974),O=n(82552),A=n(82999),_=n(98634),H=n(19253);function N(e,t){var n=e.vertex.code,N=e.fragment.code,P=t.hasModelTransformation;t.output!==h.H.Depth&&t.output!==h.H.Shadow||((0,O.S)(e,t),e.include(x.w,{linearDepth:!0,hasModelTransformation:P}),e.include(b.D,t),e.include(M.k,t),e.include(T.F,t),e.include(g.f5,t),e.vertex.uniforms.add(new A.A("nearFar",(function(e,t){return t.camera.nearFar}))),e.varyings.add("depth","float"),t.hasColorTexture&&e.fragment.uniforms.add(new H.A("tex",(function(e){return e.texture}))),n.add((0,_.H)(r||(r=(0,f.Z)(["\n      void main(void) {\n        vpos = calculateVPos();\n        vpos = subtractOrigin(vpos);\n        vpos = addVerticalOffset(vpos, localOrigin);\n        gl_Position = transformPositionWithDepth(proj, view, "," vpos, nearFar, depth);\n        forwardTextureCoordinates();\n      }\n    "])),P?"model,":"")),e.include(S.z,t),N.add((0,_.H)(o||(o=(0,f.Z)(["\n      void main(void) {\n        discardBySlice(vpos);\n        ","\n        outputDepth(depth);\n      }\n    "])),t.hasColorTexture?(0,_.H)(a||(a=(0,f.Z)(["\n        vec4 texColor = texture2D(tex, vuv0);\n        discardOrAdjustAlpha(texColor);"]))):""))),t.output===h.H.Normal&&((0,O.S)(e,t),e.include(x.w,{linearDepth:!1,hasModelTransformation:P}),e.include(y.O,t),e.include(C.Bb,t),e.include(b.D,t),e.include(M.k,t),t.hasColorTexture&&e.fragment.uniforms.add(new H.A("tex",(function(e){return e.texture}))),e.varyings.add("vPositionView","vec3"),n.add((0,_.H)(i||(i=(0,f.Z)(["\n      void main(void) {\n        vpos = calculateVPos();\n        vpos = subtractOrigin(vpos);\n        ","\n        vpos = addVerticalOffset(vpos, localOrigin);\n        gl_Position = transformPosition(proj, view, "," vpos);\n        forwardTextureCoordinates();\n      }\n    "])),t.normalType===y.h.Attribute?(0,_.H)(s||(s=(0,f.Z)(["\n        vNormalWorld = dpNormalView(vvLocalNormal(normalModel()));"]))):"",P?"model,":"")),e.include(g.f5,t),e.include(S.z,t),N.add((0,_.H)(l||(l=(0,f.Z)(["\n      void main() {\n        discardBySlice(vpos);\n        ","\n\n        ","\n        gl_FragColor = vec4(vec3(0.5) + 0.5 * normal, 1.0);\n      }\n    "])),t.hasColorTexture?(0,_.H)(c||(c=(0,f.Z)(["\n        vec4 texColor = texture2D(tex, vuv0);\n        discardOrAdjustAlpha(texColor);"]))):"",t.normalType===y.h.ScreenDerivative?(0,_.H)(u||(u=(0,f.Z)(["\n            vec3 normal = screenDerivativeNormal(vPositionView);"]))):(0,_.H)(d||(d=(0,f.Z)(["\n            vec3 normal = normalize(vNormalWorld);\n            if (gl_FrontFacing == false) normal = -normal;"])))))),t.output===h.H.Highlight&&((0,O.S)(e,t),e.include(x.w,{linearDepth:!1,hasModelTransformation:P}),e.include(b.D,t),e.include(M.k,t),t.hasColorTexture&&e.fragment.uniforms.add(new H.A("tex",(function(e){return e.texture}))),n.add((0,_.H)(p||(p=(0,f.Z)(["\n      void main(void) {\n        vpos = calculateVPos();\n        vpos = subtractOrigin(vpos);\n        vpos = addVerticalOffset(vpos, localOrigin);\n        gl_Position = transformPosition(proj, view, "," vpos);\n        forwardTextureCoordinates();\n      }\n    "])),P?"model,":"")),e.include(g.f5,t),e.include(S.z,t),e.include(w.bA),N.add((0,_.H)(m||(m=(0,f.Z)(["\n      void main() {\n        discardBySlice(vpos);\n        ","\n        outputHighlight();\n      }\n    "])),t.hasColorTexture?(0,_.H)(v||(v=(0,f.Z)(["\n        vec4 texColor = texture2D(tex, vuv0);\n        discardOrAdjustAlpha(texColor);"]))):"")))}},38171:function(e,t,n){n.d(t,{Q:function(){return h}});var r,o,a,i,s=n(30168),l=n(60113),c=n(27284),u=n(96658),d=n(98634),p=n(69253),m=n(19253),v=n(99340),f=n(4760);function h(e,t){var n=e.fragment;if(t.hasVertexTangents?(e.attributes.add(f.T.TANGENT,"vec4"),e.varyings.add("vTangent","vec4"),t.doubleSidedMode===u.q.WindingOrder?n.code.add((0,d.H)(r||(r=(0,s.Z)(["mat3 computeTangentSpace(vec3 normal) {\nfloat tangentHeadedness = gl_FrontFacing ? vTangent.w : -vTangent.w;\nvec3 tangent = normalize(gl_FrontFacing ? vTangent.xyz : -vTangent.xyz);\nvec3 bitangent = cross(normal, tangent) * tangentHeadedness;\nreturn mat3(tangent, bitangent, normal);\n}"])))):n.code.add((0,d.H)(o||(o=(0,s.Z)(["mat3 computeTangentSpace(vec3 normal) {\nfloat tangentHeadedness = vTangent.w;\nvec3 tangent = normalize(vTangent.xyz);\nvec3 bitangent = cross(normal, tangent) * tangentHeadedness;\nreturn mat3(tangent, bitangent, normal);\n}"]))))):(e.extensions.add("GL_OES_standard_derivatives"),n.code.add((0,d.H)(a||(a=(0,s.Z)(["mat3 computeTangentSpace(vec3 normal, vec3 pos, vec2 st) {\nvec3 Q1 = dFdx(pos);\nvec3 Q2 = dFdy(pos);\nvec2 stx = dFdx(st);\nvec2 sty = dFdy(st);\nfloat det = stx.t * sty.s - sty.t * stx.s;\nvec3 T = stx.t * Q2 - sty.t * Q1;\nT = T - normal * dot(normal, T);\nT *= inversesqrt(max(dot(T,T), 1.e-10));\nvec3 B = sign(det) * cross(normal, T);\nreturn mat3(T, B, normal);\n}"]))))),t.textureCoordinateType!==l.N.None){e.include(c.i,t);var h=t.supportsTextureAtlas;n.uniforms.add(t.pbrTextureBindType===v.P.Pass?(0,m.J)("normalTexture",(function(e){return e.textureNormal}),h):(0,p.F)("normalTexture",(function(e){return e.textureNormal}),h)),n.code.add((0,d.H)(i||(i=(0,s.Z)(["\n    vec3 computeTextureNormal(mat3 tangentSpace, vec2 uv) {\n      vtc.uv = uv;\n      ","\n      vec3 rawNormal = textureLookup(normalTexture, vtc).rgb * 2.0 - 1.0;\n      return tangentSpace * rawNormal;\n    }\n  "])),t.supportsTextureAtlas?"vtc.size = normalTextureSize;":""))}}},30694:function(e,t,n){n.d(t,{K:function(){return d}});var r,o,a=n(30168),i=n(90045),s=n(67077),l=n(95276),c=n(98634),u=n(19253);function d(e,t){var n=e.fragment;t.receiveAmbientOcclusion?(n.uniforms.add([new u.A("ssaoTex",(function(e,t){return t.ssaoHelper.colorTexture})),new l.N("viewportPixelSz",(function(e,t){return(0,i.s)(p,t.camera.fullViewport[0],t.camera.fullViewport[1],1/t.ssaoHelper.width,1/t.ssaoHelper.height)}))]),n.code.add((0,c.H)(r||(r=(0,a.Z)(["float evaluateAmbientOcclusion() {\nreturn 1.0 - texture2D(ssaoTex, (gl_FragCoord.xy - viewportPixelSz.xy) * viewportPixelSz.zw).a;\n}\nfloat evaluateAmbientOcclusionInverse() {\nreturn texture2D(ssaoTex, (gl_FragCoord.xy - viewportPixelSz.xy) * viewportPixelSz.zw).a;\n}"]))))):n.code.add((0,c.H)(o||(o=(0,a.Z)(["float evaluateAmbientOcclusion() { return 0.0; }\nfloat evaluateAmbientOcclusionInverse() { return 1.0; }"]))))}var p=(0,s.c)()},34975:function(e,t,n){n.d(t,{X:function(){return _}});var r,o,a,i,s,l,c,u,d,p,m,v,f,h=n(30168),g=n(60750),x=n(30694),y=n(92395),b=n(2116),C=n(41481),T=n(85586),w=n(13773),M=n(49450),S=n(58406),O=n(98634),A=n(48919);function _(e,t){var n=e.fragment;e.include(x.K,t),t.pbrMode!==C.f7.Disabled&&e.include(b.T,t),e.include(g._,t),n.constants.add("ambientBoostFactor","float",A.V),e.include(T.e),n.code.add((0,O.H)(r||(r=(0,h.Z)(["\n    const float GAMMA_SRGB = 2.1;\n    const float INV_GAMMA_SRGB = 0.4761904;\n    ","\n  "])),t.pbrMode===C.f7.Disabled?"":"const vec3 GROUND_REFLECTANCE = vec3(0.2);")),n.uniforms.add(new M.J("lightingMainDirection",(function(e,t){return t.lighting.lightingMainDirection}))),n.code.add((0,O.H)(o||(o=(0,h.Z)(["\n    float additionalDirectedAmbientLight(vec3 vPosWorld) {\n      float vndl = dot(",", lightingMainDirection);\n      return smoothstep(0.0, 1.0, clamp(vndl * 2.5, 0.0, 1.0));\n    }\n  "])),t.spherical?(0,O.H)(a||(a=(0,h.Z)(["normalize(vPosWorld)"]))):(0,O.H)(i||(i=(0,h.Z)(["vec3(0.0, 0.0, 1.0)"]))))),n.uniforms.add([new S.p("lightingGlobalFactor",(function(e,t){return t.lighting.globalFactor})),new M.J("lightingMainIntensity",(function(e,t){return t.lighting.mainLight.intensity}))]),n.code.add((0,O.H)(s||(s=(0,h.Z)(["vec3 evaluateAdditionalLighting(float ambientOcclusion, vec3 vPosWorld) {\nfloat additionalAmbientScale = additionalDirectedAmbientLight(vPosWorld);\nreturn (1.0 - ambientOcclusion) * additionalAmbientScale * ambientBoostFactor * lightingGlobalFactor * lightingMainIntensity;\n}"])))),t.pbrMode===C.f7.Disabled||t.pbrMode===C.f7.WaterOnIntegratedMesh?(e.include(y.k,t),n.code.add((0,O.H)(l||(l=(0,h.Z)(["vec3 evaluateSceneLighting(vec3 normalWorld, vec3 albedo, float shadow, float ssao, vec3 additionalLight)\n{\nvec3 mainLighting = evaluateMainLighting(normalWorld, shadow);\nvec3 ambientLighting = calculateAmbientIrradiance(normalWorld, ssao);\nvec3 albedoLinear = pow(albedo, vec3(GAMMA_SRGB));\nvec3 totalLight = mainLighting + ambientLighting + additionalLight;\ntotalLight = min(totalLight, vec3(PI));\nvec3 outColor = vec3((albedoLinear / PI) * totalLight);\nreturn pow(outColor, vec3(INV_GAMMA_SRGB));\n}"]))))):t.pbrMode!==C.f7.Normal&&t.pbrMode!==C.f7.Schematic||(n.code.add((0,O.H)(c||(c=(0,h.Z)(["const float fillLightIntensity = 0.25;\nconst float horizonLightDiffusion = 0.4;\nconst float additionalAmbientIrradianceFactor = 0.02;\nvec3 evaluateSceneLightingPBR(vec3 normal, vec3 albedo, float shadow, float ssao, vec3 additionalLight, vec3 viewDir, vec3 normalGround, vec3 mrr, vec3 _emission, float additionalAmbientIrradiance)\n{\nvec3 viewDirection = -viewDir;\nvec3 mainLightDirection = lightingMainDirection;\nvec3 h = normalize(viewDirection + mainLightDirection);\nPBRShadingInfo inputs;\ninputs.NdotL = clamp(dot(normal, mainLightDirection), 0.001, 1.0);\ninputs.NdotV = clamp(abs(dot(normal, viewDirection)), 0.001, 1.0);\ninputs.NdotH = clamp(dot(normal, h), 0.0, 1.0);\ninputs.VdotH = clamp(dot(viewDirection, h), 0.0, 1.0);\ninputs.NdotNG = clamp(dot(normal, normalGround), -1.0, 1.0);\nvec3 reflectedView = normalize(reflect(viewDirection, normal));\ninputs.RdotNG = clamp(dot(reflectedView, normalGround), -1.0, 1.0);\ninputs.albedoLinear = pow(albedo, vec3(GAMMA_SRGB));\ninputs.ssao = ssao;\ninputs.metalness = mrr[0];\ninputs.roughness = clamp(mrr[1] * mrr[1], 0.001, 0.99);"])))),n.code.add((0,O.H)(u||(u=(0,h.Z)(["inputs.f0 = (0.16 * mrr[2] * mrr[2]) * (1.0 - inputs.metalness) + inputs.albedoLinear * inputs.metalness;\ninputs.f90 = vec3(clamp(dot(inputs.f0, vec3(50.0 * 0.33)), 0.0, 1.0));\ninputs.diffuseColor = inputs.albedoLinear * (vec3(1.0) - inputs.f0) * (1.0 - inputs.metalness);"])))),t.useFillLights?n.uniforms.add(new w.U("hasFillLights",(function(e,t){return t.enableFillLights}))):n.constants.add("hasFillLights","bool",!1),n.code.add((0,O.H)(d||(d=(0,h.Z)(["vec3 ambientDir = vec3(5.0 * normalGround[1] - normalGround[0] * normalGround[2], - 5.0 * normalGround[0] - normalGround[2] * normalGround[1], normalGround[1] * normalGround[1] + normalGround[0] * normalGround[0]);\nambientDir = ambientDir != vec3(0.0)? normalize(ambientDir) : normalize(vec3(5.0, -1.0, 0.0));\ninputs.NdotAmbDir = hasFillLights ? abs(dot(normal, ambientDir)) : 1.0;\nvec3 mainLightIrradianceComponent = inputs.NdotL * (1.0 - shadow) * lightingMainIntensity;\nvec3 fillLightsIrradianceComponent = inputs.NdotAmbDir * lightingMainIntensity * fillLightIntensity;\nvec3 ambientLightIrradianceComponent = calculateAmbientIrradiance(normal, ssao) + additionalLight;\ninputs.skyIrradianceToSurface = ambientLightIrradianceComponent + mainLightIrradianceComponent + fillLightsIrradianceComponent ;\ninputs.groundIrradianceToSurface = GROUND_REFLECTANCE * ambientLightIrradianceComponent + mainLightIrradianceComponent + fillLightsIrradianceComponent ;"])))),n.uniforms.add([new S.p("lightingSpecularStrength",(function(e,t){return t.lighting.mainLight.specularStrength})),new S.p("lightingEnvironmentStrength",(function(e,t){return t.lighting.mainLight.environmentStrength}))]),n.code.add((0,O.H)(p||(p=(0,h.Z)(["vec3 horizonRingDir = inputs.RdotNG * normalGround - reflectedView;\nvec3 horizonRingH = normalize(viewDirection + horizonRingDir);\ninputs.NdotH_Horizon = dot(normal, horizonRingH);\nvec3 mainLightRadianceComponent = lightingSpecularStrength * normalDistribution(inputs.NdotH, inputs.roughness) * lightingMainIntensity * (1.0 - shadow);\nvec3 horizonLightRadianceComponent = lightingEnvironmentStrength * normalDistribution(inputs.NdotH_Horizon, min(inputs.roughness + horizonLightDiffusion, 1.0)) * lightingMainIntensity * fillLightIntensity;\nvec3 ambientLightRadianceComponent = lightingEnvironmentStrength * calculateAmbientRadiance(ssao) + additionalLight;\ninputs.skyRadianceToSurface = ambientLightRadianceComponent + mainLightRadianceComponent + horizonLightRadianceComponent;\ninputs.groundRadianceToSurface = GROUND_REFLECTANCE * (ambientLightRadianceComponent + horizonLightRadianceComponent) + mainLightRadianceComponent;\ninputs.averageAmbientRadiance = ambientLightIrradianceComponent[1] * (1.0 + GROUND_REFLECTANCE[1]);"])))),n.code.add((0,O.H)(m||(m=(0,h.Z)(["\n        vec3 reflectedColorComponent = evaluateEnvironmentIllumination(inputs);\n        vec3 additionalMaterialReflectanceComponent = inputs.albedoLinear * additionalAmbientIrradiance;\n        vec3 emissionComponent = pow(_emission, vec3(GAMMA_SRGB));\n        vec3 outColorLinear = reflectedColorComponent + additionalMaterialReflectanceComponent + emissionComponent;\n        ","\n        return outColor;\n      }\n    "])),t.pbrMode===C.f7.Schematic?(0,O.H)(v||(v=(0,h.Z)(["vec3 outColor = pow(max(vec3(0.0), outColorLinear - 0.005 * inputs.averageAmbientRadiance), vec3(INV_GAMMA_SRGB));"]))):(0,O.H)(f||(f=(0,h.Z)(["vec3 outColor = pow(blackLevelSoftCompression(outColorLinear, inputs), vec3(INV_GAMMA_SRGB));"]))))))}},96658:function(e,t,n){n.d(t,{k:function(){return p},q:function(){return s}});var r,o,a,i,s,l,c=n(30168),u=n(41644),d=n(98634);function p(e,t){var n=e.fragment;switch(n.code.add((0,d.H)(r||(r=(0,c.Z)(["struct ShadingNormalParameters {\nvec3 normalView;\nvec3 viewDirection;\n} shadingParams;"])))),t.doubleSidedMode){case s.None:n.code.add((0,d.H)(o||(o=(0,c.Z)(["vec3 shadingNormal(ShadingNormalParameters params) {\nreturn normalize(params.normalView);\n}"]))));break;case s.View:n.code.add((0,d.H)(a||(a=(0,c.Z)(["vec3 shadingNormal(ShadingNormalParameters params) {\nreturn dot(params.normalView, params.viewDirection) > 0.0 ? normalize(-params.normalView) : normalize(params.normalView);\n}"]))));break;case s.WindingOrder:n.code.add((0,d.H)(i||(i=(0,c.Z)(["vec3 shadingNormal(ShadingNormalParameters params) {\nreturn gl_FrontFacing ? normalize(params.normalView) : normalize(-params.normalView);\n}"]))));break;default:(0,u.Bg)(t.doubleSidedMode);case s.COUNT:}}(l=s||(s={}))[l.None=0]="None",l[l.View=1]="View",l[l.WindingOrder=2]="WindingOrder",l[l.COUNT=3]="COUNT"},65974:function(e,t,n){n.d(t,{z:function(){return y}});var r,o=n(30168),a=n(26461),i=n(98634);function s(e){e.fragment.code.add((0,i.H)(r||(r=(0,o.Z)(["\n    #define discardOrAdjustAlpha(color) { if (color.a < ",") { discard; } }\n  "])),i.H.float(a.b)))}var l,c,u,d=n(43144),p=n(15671),m=n(60136),v=n(54062),f=n(61809),h=n(99340),g=(f.x,n(58406)),x=n(68401);function y(e,t){b(e,t,new g.p("textureAlphaCutoff",(function(e){return e.textureAlphaCutoff})))}function b(e,t,n){var r=e.fragment;switch(t.alphaDiscardMode!==x.JJ.Mask&&t.alphaDiscardMode!==x.JJ.MaskBlend||r.uniforms.add(n),t.alphaDiscardMode){case x.JJ.Blend:return e.include(s);case x.JJ.Opaque:r.code.add((0,i.H)(l||(l=(0,o.Z)(["void discardOrAdjustAlpha(inout vec4 color) {\ncolor.a = 1.0;\n}"]))));break;case x.JJ.Mask:r.code.add((0,i.H)(c||(c=(0,o.Z)(["#define discardOrAdjustAlpha(color) { if (color.a < textureAlphaCutoff) { discard; } else { color.a = 1.0; } }"]))));break;case x.JJ.MaskBlend:e.fragment.code.add((0,i.H)(u||(u=(0,o.Z)(["#define discardOrAdjustAlpha(color) { if (color.a < textureAlphaCutoff) { discard; } }"]))))}}},14282:function(e,t,n){n.d(t,{a:function(){return l}});var r,o=n(30168),a=n(71011),i=n(98634),s=n(37825);function l(e,t){var n=(0,i.H)(r||(r=(0,o.Z)(["\n  /*\n  *  ","\n  *  ","\n  */\n  "])),t.name,t.output===a.H.Color?"RenderOutput: Color":t.output===a.H.Depth?"RenderOutput: Depth":t.output===a.H.Shadow?"RenderOutput: Shadow":t.output===a.H.Normal?"RenderOutput: Normal":t.output===a.H.Highlight?"RenderOutput: Highlight":"");(0,s.CG)()&&(e.fragment.code.add(n),e.vertex.code.add(n))}},71033:function(e,t,n){n.d(t,{y:function(){return l}});var r,o=n(30168),a=n(49420),i=n(116),s=n(98634);function l(e){e.include(i.Y),e.code.add((0,s.H)(r||(r=(0,o.Z)(["\n    vec3 mixExternalColor(vec3 internalColor, vec3 textureColor, vec3 externalColor, int mode) {\n      // workaround for artifacts in OSX using Intel Iris Pro\n      // see: https://devtopia.esri.com/WebGIS/arcgis-js-api/issues/10475\n      vec3 internalMixed = internalColor * textureColor;\n      vec3 allMixed = internalMixed * externalColor;\n\n      if (mode == ",") {\n        return allMixed;\n      }\n      if (mode == ",") {\n        return internalMixed;\n      }\n      if (mode == ",") {\n        return externalColor;\n      }\n\n      // tint (or something invalid)\n      float vIn = rgb2v(internalMixed);\n      vec3 hsvTint = rgb2hsv(externalColor);\n      vec3 hsvOut = vec3(hsvTint.x, hsvTint.y, vIn * hsvTint.z);\n      return hsv2rgb(hsvOut);\n    }\n\n    float mixExternalOpacity(float internalOpacity, float textureOpacity, float externalOpacity, int mode) {\n      // workaround for artifacts in OSX using Intel Iris Pro\n      // see: https://devtopia.esri.com/WebGIS/arcgis-js-api/issues/10475\n      float internalMixed = internalOpacity * textureOpacity;\n      float allMixed = internalMixed * externalOpacity;\n\n      if (mode == ",") {\n        return internalMixed;\n      }\n      if (mode == ",") {\n        return externalOpacity;\n      }\n\n      // multiply or tint (or something invalid)\n      return allMixed;\n    }\n  "])),s.H.int(a.a9.Multiply),s.H.int(a.a9.Ignore),s.H.int(a.a9.Replace),s.H.int(a.a9.Ignore),s.H.int(a.a9.Replace)))}},86802:function(e,t,n){n.d(t,{Gp:function(){return I},RL:function(){return k}});var r=n(1413),o=n(15671),a=n(43144),i=n(11752),s=n(61120),l=n(60136),c=n(54062),u=n(92026),d=n(11186),p=n(71353),m=n(50951),v=n(55158),f=n(71011),h=n(73782),g=n(96658),x=n(41481),y=n(68401),b=n(17363),C=n(56529),T=n(78041),w=n(68198),M=n(93822),S=n(4760),O=n(76783),A=n(33236),_=n(22909),H=n(50531),N=n(27366),P=n(60113),L=n(33559),Z=function(e){(0,l.Z)(n,e);var t=(0,c.Z)(n);function n(){var e;return(0,o.Z)(this,n),(e=t.apply(this,arguments)).output=f.H.Color,e.alphaDiscardMode=y.JJ.Opaque,e.doubleSidedMode=g.q.None,e.pbrMode=x.f7.Disabled,e.cullFace=y.Vr.None,e.transparencyPassType=y.Am.NONE,e.normalType=h.h.Attribute,e.textureCoordinateType=P.N.None,e.customDepthTest=y.Gv.Less,e.spherical=!1,e.hasVertexColors=!1,e.hasSymbolColors=!1,e.hasVerticalOffset=!1,e.hasSlicePlane=!1,e.hasSliceHighlight=!0,e.hasColorTexture=!1,e.hasMetalnessAndRoughnessTexture=!1,e.hasEmissionTexture=!1,e.hasOcclusionTexture=!1,e.hasNormalTexture=!1,e.hasScreenSizePerspective=!1,e.hasVertexTangents=!1,e.hasOccludees=!1,e.hasMultipassTerrain=!1,e.hasModelTransformation=!1,e.offsetBackfaces=!1,e.vvSize=!1,e.vvColor=!1,e.receiveShadows=!1,e.receiveAmbientOcclusion=!1,e.textureAlphaPremultiplied=!1,e.instanced=!1,e.instancedColor=!1,e.instancedDoublePrecision=!1,e.doublePrecisionRequiresObfuscation=!1,e.writeDepth=!0,e.transparent=!1,e.enableOffset=!0,e.cullAboveGround=!1,e.snowCover=!1,e}return(0,a.Z)(n)}(n(8883).W);(0,N._)([(0,L.o)({count:f.H.COUNT})],Z.prototype,"output",void 0),(0,N._)([(0,L.o)({count:y.JJ.COUNT})],Z.prototype,"alphaDiscardMode",void 0),(0,N._)([(0,L.o)({count:g.q.COUNT})],Z.prototype,"doubleSidedMode",void 0),(0,N._)([(0,L.o)({count:x.f7.COUNT})],Z.prototype,"pbrMode",void 0),(0,N._)([(0,L.o)({count:y.Vr.COUNT})],Z.prototype,"cullFace",void 0),(0,N._)([(0,L.o)({count:y.Am.COUNT})],Z.prototype,"transparencyPassType",void 0),(0,N._)([(0,L.o)({count:h.h.COUNT})],Z.prototype,"normalType",void 0),(0,N._)([(0,L.o)({count:P.N.COUNT})],Z.prototype,"textureCoordinateType",void 0),(0,N._)([(0,L.o)({count:y.Gv.COUNT})],Z.prototype,"customDepthTest",void 0),(0,N._)([(0,L.o)()],Z.prototype,"spherical",void 0),(0,N._)([(0,L.o)()],Z.prototype,"hasVertexColors",void 0),(0,N._)([(0,L.o)()],Z.prototype,"hasSymbolColors",void 0),(0,N._)([(0,L.o)()],Z.prototype,"hasVerticalOffset",void 0),(0,N._)([(0,L.o)()],Z.prototype,"hasSlicePlane",void 0),(0,N._)([(0,L.o)()],Z.prototype,"hasSliceHighlight",void 0),(0,N._)([(0,L.o)()],Z.prototype,"hasColorTexture",void 0),(0,N._)([(0,L.o)()],Z.prototype,"hasMetalnessAndRoughnessTexture",void 0),(0,N._)([(0,L.o)()],Z.prototype,"hasEmissionTexture",void 0),(0,N._)([(0,L.o)()],Z.prototype,"hasOcclusionTexture",void 0),(0,N._)([(0,L.o)()],Z.prototype,"hasNormalTexture",void 0),(0,N._)([(0,L.o)()],Z.prototype,"hasScreenSizePerspective",void 0),(0,N._)([(0,L.o)()],Z.prototype,"hasVertexTangents",void 0),(0,N._)([(0,L.o)()],Z.prototype,"hasOccludees",void 0),(0,N._)([(0,L.o)()],Z.prototype,"hasMultipassTerrain",void 0),(0,N._)([(0,L.o)()],Z.prototype,"hasModelTransformation",void 0),(0,N._)([(0,L.o)()],Z.prototype,"offsetBackfaces",void 0),(0,N._)([(0,L.o)()],Z.prototype,"vvSize",void 0),(0,N._)([(0,L.o)()],Z.prototype,"vvColor",void 0),(0,N._)([(0,L.o)()],Z.prototype,"receiveShadows",void 0),(0,N._)([(0,L.o)()],Z.prototype,"receiveAmbientOcclusion",void 0),(0,N._)([(0,L.o)()],Z.prototype,"textureAlphaPremultiplied",void 0),(0,N._)([(0,L.o)()],Z.prototype,"instanced",void 0),(0,N._)([(0,L.o)()],Z.prototype,"instancedColor",void 0),(0,N._)([(0,L.o)()],Z.prototype,"instancedDoublePrecision",void 0),(0,N._)([(0,L.o)()],Z.prototype,"doublePrecisionRequiresObfuscation",void 0),(0,N._)([(0,L.o)()],Z.prototype,"writeDepth",void 0),(0,N._)([(0,L.o)()],Z.prototype,"transparent",void 0),(0,N._)([(0,L.o)()],Z.prototype,"enableOffset",void 0),(0,N._)([(0,L.o)()],Z.prototype,"cullAboveGround",void 0),(0,N._)([(0,L.o)()],Z.prototype,"snowCover",void 0),(0,N._)([(0,L.o)({constValue:!0})],Z.prototype,"hasVvInstancing",void 0),(0,N._)([(0,L.o)({constValue:!1})],Z.prototype,"useCustomDTRExponentForWater",void 0),(0,N._)([(0,L.o)({constValue:!1})],Z.prototype,"supportsTextureAtlas",void 0),(0,N._)([(0,L.o)({constValue:!0})],Z.prototype,"useFillLights",void 0);var R=n(82144),D=n(40563),E=function(e){(0,l.Z)(n,e);var t=(0,c.Z)(n);function n(){return(0,o.Z)(this,n),t.apply(this,arguments)}return(0,a.Z)(n,[{key:"initializeConfiguration",value:function(e,t){(0,i.Z)((0,s.Z)(n.prototype),"initializeConfiguration",this).call(this,e,t),t.hasMetalnessAndRoughnessTexture=!1,t.hasEmissionTexture=!1,t.hasOcclusionTexture=!1,t.hasNormalTexture=!1,t.hasModelTransformation=!1,t.normalType=h.h.Attribute,t.doubleSidedMode=g.q.WindingOrder,t.hasVertexTangents=!1}},{key:"initializeProgram",value:function(e){return this._initializeProgram(e,n.shader)}}]),n}(H.tT);E.shader=new R.J(D.R,(function(){return n.e(601).then(n.bind(n,50601))}));var I=function(e){(0,l.Z)(n,e);var t=(0,c.Z)(n);function n(e){var r;return(0,o.Z)(this,n),(r=t.call(this,e,F)).supportsEdges=!0,r.techniqueConfig=new Z,r.vertexBufferLayout=function(e){var t=e.textureId||e.normalTextureId||e.metallicRoughnessTextureId||e.emissiveTextureId||e.occlusionTextureId,n=(0,v.U$)().vec3f(S.T.POSITION).vec3f(S.T.NORMAL);return e.hasVertexTangents&&n.vec4f(S.T.TANGENT),t&&n.vec2f(S.T.UV0),e.hasVertexColors&&n.vec4u8(S.T.COLOR),e.hasSymbolColors&&n.vec4u8(S.T.SYMBOLCOLOR),n}(r.parameters),r.instanceBufferLayout=e.instanced?k(r.parameters):null,r}return(0,a.Z)(n,[{key:"isVisibleInPass",value:function(e){return e!==w.C.MATERIAL_DEPTH_SHADOWMAP_ALL&&e!==w.C.MATERIAL_DEPTH_SHADOWMAP_DEFAULT&&e!==w.C.MATERIAL_DEPTH_SHADOWMAP_HIGHLIGHT||this.parameters.castShadows}},{key:"isVisible",value:function(){var e=this.parameters;if(!(0,i.Z)((0,s.Z)(n.prototype),"isVisible",this).call(this)||0===e.layerOpacity)return!1;var t=e.instanced,r=e.hasVertexColors,o=e.hasSymbolColors,a=e.vvColorEnabled,l=(0,u.pC)(t)&&t.includes("color"),c="replace"===e.colorMixMode,d=e.opacity>0,p=e.externalColor&&e.externalColor[3]>0;return r&&(l||a||o)?!!c||d:r?c?p:d:l||a||o?!!c||d:c?p:d}},{key:"getConfiguration",value:function(e,t){return this.techniqueConfig.output=e,this.techniqueConfig.hasNormalTexture=!!this.parameters.normalTextureId,this.techniqueConfig.hasColorTexture=!!this.parameters.textureId,this.techniqueConfig.hasVertexTangents=this.parameters.hasVertexTangents,this.techniqueConfig.instanced=!!this.parameters.instanced,this.techniqueConfig.instancedDoublePrecision=this.parameters.instancedDoublePrecision,this.techniqueConfig.vvSize=this.parameters.vvSizeEnabled,this.techniqueConfig.hasVerticalOffset=(0,u.pC)(this.parameters.verticalOffset),this.techniqueConfig.hasScreenSizePerspective=(0,u.pC)(this.parameters.screenSizePerspective),this.techniqueConfig.hasSlicePlane=this.parameters.hasSlicePlane,this.techniqueConfig.hasSliceHighlight=this.parameters.hasSliceHighlight,this.techniqueConfig.alphaDiscardMode=this.parameters.textureAlphaMode,this.techniqueConfig.normalType="screenDerivative"===this.parameters.normals?h.h.ScreenDerivative:h.h.Attribute,this.techniqueConfig.transparent=this.parameters.transparent,this.techniqueConfig.writeDepth=this.parameters.writeDepth,(0,u.pC)(this.parameters.customDepthTest)&&(this.techniqueConfig.customDepthTest=this.parameters.customDepthTest),this.techniqueConfig.hasOccludees=this.parameters.hasOccludees,this.techniqueConfig.cullFace=this.parameters.hasSlicePlane?y.Vr.None:this.parameters.cullFace,this.techniqueConfig.hasMultipassTerrain=t.multipassTerrain.enabled,this.techniqueConfig.cullAboveGround=t.multipassTerrain.cullAboveGround,this.techniqueConfig.hasModelTransformation=(0,u.pC)(this.parameters.modelTransformation),e!==f.H.Color&&e!==f.H.Alpha||(this.techniqueConfig.hasVertexColors=this.parameters.hasVertexColors,this.techniqueConfig.hasSymbolColors=this.parameters.hasSymbolColors,this.parameters.treeRendering?this.techniqueConfig.doubleSidedMode=g.q.WindingOrder:this.techniqueConfig.doubleSidedMode=this.parameters.doubleSided&&"normal"===this.parameters.doubleSidedType?g.q.View:this.parameters.doubleSided&&"winding-order"===this.parameters.doubleSidedType?g.q.WindingOrder:g.q.None,this.techniqueConfig.instancedColor=(0,u.pC)(this.parameters.instanced)&&this.parameters.instanced.includes("color"),this.techniqueConfig.receiveShadows=this.parameters.receiveShadows&&this.parameters.shadowMappingEnabled,this.techniqueConfig.receiveAmbientOcclusion=!!t.ssaoHelper.ready&&this.parameters.receiveSSAO,this.techniqueConfig.vvColor=this.parameters.vvColorEnabled,this.techniqueConfig.textureAlphaPremultiplied=!!this.parameters.textureAlphaPremultiplied,this.techniqueConfig.pbrMode=this.parameters.usePBR?this.parameters.isSchematic?x.f7.Schematic:x.f7.Normal:x.f7.Disabled,this.techniqueConfig.hasMetalnessAndRoughnessTexture=!!this.parameters.metallicRoughnessTextureId,this.techniqueConfig.hasEmissionTexture=!!this.parameters.emissiveTextureId,this.techniqueConfig.hasOcclusionTexture=!!this.parameters.occlusionTextureId,this.techniqueConfig.offsetBackfaces=!(!this.parameters.transparent||!this.parameters.offsetTransparentBackfaces),this.techniqueConfig.transparencyPassType=t.transparencyPassType,this.techniqueConfig.enableOffset=t.camera.relativeElevation<T.ve,this.techniqueConfig.snowCover=this.hasSnowCover(t)),this.techniqueConfig}},{key:"hasSnowCover",value:function(e){return(0,u.pC)(e.weather)&&e.weatherVisible&&"snowy"===e.weather.type&&"enabled"===e.weather.snowCover}},{key:"intersect",value:function(e,t,n,r,o,a,i){if((0,u.pC)(this.parameters.verticalOffset)){var s=r.camera;(0,d.s)(j,n[12],n[13],n[14]);var l=null;switch(r.viewingMode){case m.JY.Global:l=(0,d.n)(W,j);break;case m.JY.Local:l=(0,d.c)(W,J)}var c=0,p=(0,d.b)(K,j,s.eye),v=(0,d.l)(p),f=(0,d.g)(p,p,1/v),h=null;this.parameters.screenSizePerspective&&(h=(0,d.e)(l,f)),c+=(0,_.Hx)(s,v,this.parameters.verticalOffset,h,this.parameters.screenSizePerspective),(0,d.g)(l,l,c),(0,d.t)(U,l,r.transform.inverseRotation),o=(0,d.b)(G,o,U),a=(0,d.b)(q,a,U)}(0,_.Bw)(e,t,r,o,a,(0,O.W9)(r.verticalOffset),i)}},{key:"requiresSlot",value:function(e){return e===(this.parameters.transparent?this.parameters.writeDepth?M.r.TRANSPARENT_MATERIAL:M.r.TRANSPARENT_DEPTH_WRITE_DISABLED_MATERIAL:M.r.OPAQUE_MATERIAL)||e===M.r.DRAPED_MATERIAL}},{key:"createGLMaterial",value:function(e){return e.output===f.H.Color||e.output===f.H.Alpha||e.output===f.H.Depth||e.output===f.H.Normal||e.output===f.H.Shadow||e.output===f.H.Highlight?new B(e):null}},{key:"createBufferWriter",value:function(){return new V(this.vertexBufferLayout,this.instanceBufferLayout)}}]),n}(C.F5),B=function(e){(0,l.Z)(n,e);var t=(0,c.Z)(n);function n(e){return(0,o.Z)(this,n),t.call(this,(0,r.Z)((0,r.Z)({},e),e.material.parameters))}return(0,a.Z)(n,[{key:"_updateParameters",value:function(e){var t=this._material.parameters;this.updateTexture(t.textureId);var n=e.camera.viewInverseTransposeMatrix;return(0,d.s)(t.origin,n[3],n[7],n[11]),this._material.setParameters(this.textureBindParameters),this.ensureTechnique(t.treeRendering?E:H.tT,e)}},{key:"_updateShadowState",value:function(e){e.shadowMap.enabled!==this._material.parameters.shadowMappingEnabled&&this._material.setParameters({shadowMappingEnabled:e.shadowMap.enabled})}},{key:"_updateOccludeeState",value:function(e){e.hasOccludees!==this._material.parameters.hasOccludees&&this._material.setParameters({hasOccludees:e.hasOccludees})}},{key:"beginSlot",value:function(e){return this._output!==f.H.Color&&this._output!==f.H.Alpha||(this._updateShadowState(e),this._updateOccludeeState(e)),this._updateParameters(e)}}]),n}(b.F),z=function(e){(0,l.Z)(n,e);var t=(0,c.Z)(n);function n(){var e;return(0,o.Z)(this,n),(e=t.apply(this,arguments)).initTextureTransparent=!1,e.treeRendering=!1,e.hasVertexTangents=!1,e}return(0,a.Z)(n)}(H.em),F=new z,V=function(){function e(t,n){(0,o.Z)(this,e),this.vertexBufferLayout=t,this.instanceBufferLayout=n}return(0,a.Z)(e,[{key:"allocate",value:function(e){return this.vertexBufferLayout.createBuffer(e)}},{key:"elementCount",value:function(e){return e.indices.get(S.T.POSITION).length}},{key:"write",value:function(e,t,n,r){(0,A.NK)(t,this.vertexBufferLayout,e.transformation,e.invTranspTransformation,n,r)}}]),e}();function k(e){var t=(0,v.U$)();return t=e.instancedDoublePrecision?t.vec3f(S.T.MODELORIGINHI).vec3f(S.T.MODELORIGINLO).mat3f(S.T.MODEL).mat3f(S.T.MODELNORMAL):t.mat4f(S.T.MODEL).mat4f(S.T.MODELNORMAL),(0,u.pC)(e.instanced)&&e.instanced.includes("color")&&(t=t.vec4f(S.T.INSTANCECOLOR)),(0,u.pC)(e.instanced)&&e.instanced.includes("featureAttribute")&&(t=t.vec4f(S.T.INSTANCEFEATUREATTRIBUTE)),t}var G=(0,p.c)(),q=(0,p.c)(),J=(0,p.f)(0,0,1),W=(0,p.c)(),U=(0,p.c)(),j=(0,p.c)(),K=(0,p.c)()},50531:function(e,t,n){n.d(t,{Qm:function(){return N},em:function(){return H},tT:function(){return P}});var r=n(11752),o=n(61120),a=n(43144),i=n(15671),s=n(60136),l=n(54062),c=n(11873),u=n(71353),d=n(67077),p=n(50951),m=n(71011),v=n(60113),f=n(85380),h=n(26461),g=n(27254),x=n(82144),y=n(31132),b=n(68401),C=n(7566),T=n(56529),w=n(78041),M=n(27627),S=n(50411),O=n(65630),A=n(8548),_=n(36207),H=function(e){(0,s.Z)(n,e);var t=(0,l.Z)(n);function n(){var e;return(0,i.Z)(this,n),(e=t.apply(this,arguments)).isSchematic=!1,e.usePBR=!1,e.mrrFactors=(0,u.f)(0,1,.5),e.hasVertexColors=!1,e.hasSymbolColors=!1,e.doubleSided=!1,e.doubleSidedType="normal",e.cullFace=b.Vr.Back,e.emissiveFactor=(0,u.f)(0,0,0),e.instancedDoublePrecision=!1,e.normals="default",e.receiveSSAO=!0,e.receiveShadows=!0,e.castShadows=!0,e.shadowMappingEnabled=!1,e.ambient=(0,u.f)(.2,.2,.2),e.diffuse=(0,u.f)(.8,.8,.8),e.externalColor=(0,d.f)(1,1,1,1),e.colorMixMode="multiply",e.opacity=1,e.layerOpacity=1,e.origin=(0,u.c)(),e.hasSlicePlane=!1,e.hasSliceHighlight=!0,e.offsetTransparentBackfaces=!1,e.vvSizeEnabled=!1,e.vvSizeMinSize=[1,1,1],e.vvSizeMaxSize=[100,100,100],e.vvSizeOffset=[0,0,0],e.vvSizeFactor=[1,1,1],e.vvSizeValue=[1,1,1],e.vvColorEnabled=!1,e.vvColorValues=[0,0,0,0,0,0,0,0],e.vvColorColors=[1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0],e.vvSymbolAnchor=[0,0,0],e.vvSymbolRotationMatrix=(0,c.c)(),e.vvOpacityEnabled=!1,e.vvOpacityValues=[],e.vvOpacityOpacities=[],e.transparent=!1,e.writeDepth=!0,e.customDepthTest=b.Gv.Less,e.textureAlphaMode=b.JJ.Blend,e.textureAlphaCutoff=h.F,e.textureAlphaPremultiplied=!1,e.hasOccludees=!1,e.renderOccluded=T.yD.Occlude,e}return(0,a.Z)(n)}(f.d4),N=function(e){(0,s.Z)(n,e);var t=(0,l.Z)(n);function n(){var e;return(0,i.Z)(this,n),(e=t.apply(this,arguments)).origin=(0,u.c)(),e.slicePlaneLocalOrigin=e.origin,e}return(0,a.Z)(n)}(f.Pf),P=function(e){(0,s.Z)(n,e);var t=(0,l.Z)(n);function n(){return(0,i.Z)(this,n),t.apply(this,arguments)}return(0,a.Z)(n,[{key:"initializeConfiguration",value:function(e,t){t.spherical=e.viewingMode===p.JY.Global,t.doublePrecisionRequiresObfuscation=(0,g.I)(e.rctx),t.textureCoordinateType=t.hasColorTexture||t.hasMetalnessAndRoughnessTexture||t.hasEmissionTexture||t.hasOcclusionTexture||t.hasNormalTexture?v.N.Default:v.N.None}},{key:"initializeProgram",value:function(e){return this._initializeProgram(e,n.shader)}},{key:"_initializeProgram",value:function(e,t){var n=t.get().build(this.configuration);return new M.$(e.rctx,n,C.i)}},{key:"_convertDepthTestFunction",value:function(e){return e===b.Gv.Lequal?A.wb.LEQUAL:A.wb.LESS}},{key:"_setPipeline",value:function(e,t){var n=this.configuration,r=e===b.Am.NONE,o=e===b.Am.FrontFace;return(0,_.sm)({blending:n.output!==m.H.Color&&n.output!==m.H.Alpha||!n.transparent?null:r?w.wu:(0,w.j7)(e),culling:L(n)&&(0,_.zp)(n.cullFace),depthTest:{func:(0,w.Bh)(e,this._convertDepthTestFunction(n.customDepthTest))},depthWrite:r||o?n.writeDepth&&_.LZ:null,colorWrite:_.BK,stencilWrite:n.hasOccludees?S.s3:null,stencilTest:n.hasOccludees?t?S.eD:S.RY:null,polygonOffset:r||o?null:(0,w.je)(n.enableOffset)})}},{key:"initializePipeline",value:function(){return this._occludeePipelineState=this._setPipeline(this.configuration.transparencyPassType,!0),this._setPipeline(this.configuration.transparencyPassType,!1)}},{key:"getPipelineState",value:function(e,t){return t?this._occludeePipelineState:(0,r.Z)((0,o.Z)(n.prototype),"getPipelineState",this).call(this,e,t)}}]),n}(y.A);function L(e){return e.cullFace!==b.Vr.None||!e.hasSlicePlane&&!e.transparent&&!e.doubleSidedMode}P.shader=new x.J(O.D,(function(){return n.e(294).then(n.bind(n,40294))}))}}]);
//# sourceMappingURL=4265.8ffdb780.chunk.js.map