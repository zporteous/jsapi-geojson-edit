"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[4134],{82218:function(e,t,n){n.d(t,{a:function(){return m},c:function(){return _},g:function(){return C},h:function(){return N},u:function(){return Z}});var i=n(37762),r=n(43144),a=n(15671),o=(n(93169),n(32718)),s=n(16889),l=n(21530),u=n(14226),c=n(81949),d=n(11186),f=n(71353),v=n(14320),h=n(85981),p=n(55652),g=n(40885),y=n(40927),b=n(11185),w=o.Z.getLogger("esri.views.3d.support.geometryUtils.boundedPlane"),k=(0,r.Z)((function e(){(0,a.Z)(this,e),this.plane=(0,p.Ue)(),this.origin=(0,f.c)(),this.basis1=(0,f.c)(),this.basis2=(0,f.c)()}));function _(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:V;return{plane:(0,p.Ue)(e.plane),origin:(0,f.a)(e.origin),basis1:(0,f.a)(e.basis1),basis2:(0,f.a)(e.basis2)}}function m(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:_();return I(e.origin,e.basis1,e.basis2,t)}function I(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:_();return(0,d.c)(i.origin,e),(0,d.c)(i.basis1,t),(0,d.c)(i.basis2,n),Z(i),A(i,"fromValues()"),i}function Z(e){(0,p.my)(e.basis2,e.basis1,e.origin,e.plane)}function S(e,t,n){e!==n&&m(e,n);var i=(0,d.g)(b.WM.get(),x(e),t);return(0,d.a)(n.origin,n.origin,i),n.plane[3]-=t,n}function C(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:_(),n=(e[2]-e[0])/2,i=(e[3]-e[1])/2;return(0,d.s)(t.origin,e[0]+n,e[1]+i,0),(0,d.s)(t.basis1,n,0,0),(0,d.s)(t.basis2,0,i,0),(0,p.al)(0,0,1,0,t.plane),t}function M(e,t,n){return!!(0,p.BR)(e.plane,t,n)&&R(e,n)}function O(e,t,n){var r=L.get();j(e,t,r,L.get());var a,o=Number.POSITIVE_INFINITY,l=(0,i.Z)(D);try{for(l.s();!(a=l.n()).done;){var u=z(e,a.value,U.get()),c=b.WM.get();if((0,p.rx)(r,u,c)){var f=(0,d.r)(b.WM.get(),t.origin,c),v=Math.abs((0,s.ZF)((0,d.e)(t.direction,f)));v<o&&(o=v,(0,d.c)(n,c))}}}catch(h){l.e(h)}finally{l.f()}return o===Number.POSITIVE_INFINITY?H(e,t,n):n}function H(e,t,n){if(M(e,t,n))return n;var r=L.get(),a=L.get();j(e,t,r,a);var o,s=Number.POSITIVE_INFINITY,l=(0,i.Z)(D);try{for(l.s();!(o=l.n()).done;){var u=z(e,o.value,U.get()),c=b.WM.get();if((0,p.dZ)(r,u,c)){var f=(0,g.Jk)(t,c);if(!(0,p.Ac)(a,c))continue;f<s&&(s=f,(0,d.c)(n,c))}}}catch(v){l.e(v)}finally{l.f()}return E(e,t.origin)<s&&T(e,t.origin,n),n}function T(e,t,n){var i=(0,p.nF)(e.plane,t,b.WM.get()),r=(0,h.ct)(F(e,e.basis1),i,-1,1,b.WM.get()),a=(0,h.ct)(F(e,e.basis2),i,-1,1,b.WM.get());return(0,d.b)(n,(0,d.a)(b.WM.get(),r,a),e.origin),n}function P(e,t,n){var i=e.origin,r=e.basis1,a=e.basis2,o=(0,d.b)(b.WM.get(),t,i),s=(0,y.SR)(r,o),l=(0,y.SR)(a,o),u=(0,y.SR)(x(e),o);return(0,d.s)(n,s,l,u)}function E(e,t){var n=P(e,t,b.WM.get()),i=e.basis1,r=e.basis2,a=(0,d.l)(i),o=(0,d.l)(r),s=Math.max(Math.abs(n[0])-a,0),l=Math.max(Math.abs(n[1])-o,0),u=n[2];return s*s+l*l+u*u}function N(e,t){return Math.sqrt(E(e,t))}function W(e,t){var n=-e.plane[3];return(0,y.SR)(x(e),t)-n}function x(e){return(0,p.mJ)(e.plane)}function R(e,t){var n=(0,d.b)(b.WM.get(),t,e.origin),i=(0,d.p)(e.basis1),r=(0,d.p)(e.basis2),a=(0,d.e)(e.basis1,n),o=(0,d.e)(e.basis2,n);return-a-i<0&&a-i<0&&-o-r<0&&o-r<0}function F(e,t){var n=U.get();return(0,d.c)(n.origin,e.origin),(0,d.c)(n.vector,t),n}function z(e,t,n){var i=e.basis1,r=e.basis2,a=e.origin,o=(0,d.g)(b.WM.get(),i,t.origin[0]),s=(0,d.g)(b.WM.get(),r,t.origin[1]);(0,d.a)(n.origin,o,s),(0,d.a)(n.origin,n.origin,a);var l=(0,d.g)(b.WM.get(),i,t.direction[0]),u=(0,d.g)(b.WM.get(),r,t.direction[1]);return(0,d.g)(n.vector,(0,d.a)(l,l,u),2),n}function A(e,t){Math.abs((0,d.e)(e.basis1,e.basis2)/((0,d.l)(e.basis1)*(0,d.l)(e.basis2)))>1e-6&&w.warn(t,"Provided basis vectors are not perpendicular"),Math.abs((0,d.e)(e.basis1,x(e)))>1e-6&&w.warn(t,"Basis vectors and plane normal are not perpendicular"),Math.abs(-(0,d.e)(x(e),e.origin)-e.plane[3])>1e-6&&w.warn(t,"Plane offset is not consistent with plane origin")}function j(e,t,n,i){var r=x(e);(0,p.my)(r,t.direction,t.origin,n),(0,p.my)((0,p.mJ)(n),r,t.origin,i)}var V={plane:(0,p.Ue)(),origin:(0,f.f)(0,0,0),basis1:(0,f.f)(1,0,0),basis2:(0,f.f)(0,1,0)},L=new l.x(p.Ue),U=new l.x(h.Ue),J=(0,f.c)(),B=new l.x((function(){return{origin:null,basis1:null,basis2:null,plane:null}})),D=[{origin:[-1,-1],direction:[1,0]},{origin:[1,-1],direction:[0,1]},{origin:[1,1],direction:[-1,0]},{origin:[-1,1],direction:[0,-1]}],Y=(0,c.c)(),q=(0,c.c)();Object.freeze(Object.defineProperty({__proto__:null,BoundedPlaneClass:k,create:_,wrap:function(e,t,n){var i=B.get();return i.origin=e,i.basis1=t,i.basis2=n,i.plane=(0,p.re)(0,0,0,0),Z(i),i},copy:m,copyWithoutVerify:function(e,t){(0,d.c)(t.origin,e.origin),(0,d.c)(t.basis1,e.basis1),(0,d.c)(t.basis2,e.basis2),(0,p.JG)(t.plane,e.plane)},fromValues:I,updateUnboundedPlane:Z,elevate:S,setExtent:function(e,t,n){return C(t,n),S(n,W(e,e.origin),n),n},fromAABoundingRect:C,intersectRay:M,intersectRayClosestSilhouette:function(e,t,n){if(M(e,t,n))return n;var i=O(e,t,b.WM.get());return(0,d.a)(n,t.origin,(0,d.g)(b.WM.get(),t.direction,(0,d.i)(t.origin,i)/(0,d.l)(t.direction))),n},closestPointOnSilhouette:O,closestPoint:H,projectPoint:T,projectPointLocal:P,distance2:E,distance:N,distanceToSilhouette:function(e,t){var n,r=Number.NEGATIVE_INFINITY,a=(0,i.Z)(D);try{for(a.s();!(n=a.n()).done;){var o=z(e,n.value,U.get()),s=(0,h.Jk)(o,t);s>r&&(r=s)}}catch(l){a.e(l)}finally{a.f()}return Math.sqrt(r)},extrusionContainsPoint:function(e,t){return(0,p.Ac)(e.plane,t)&&R(e,t)},axisAt:function(e,t,n,i){return function(e,t,n){switch(t){case v.R.X:(0,d.c)(n,e.basis1),(0,d.n)(n,n);break;case v.R.Y:(0,d.c)(n,e.basis2),(0,d.n)(n,n);break;case v.R.Z:(0,d.c)(n,x(e))}return n}(e,n,i)},altitudeAt:W,setAltitudeAt:function(e,t,n,i){var r=W(e,t),a=(0,d.g)(J,x(e),n-r);return(0,d.a)(i,t,a),i},equals:function(e,t){return(0,d.k)(e.basis1,t.basis1)&&(0,d.k)(e.basis2,t.basis2)&&(0,d.k)(e.origin,t.origin)},transform:function(e,t,n){return e!==n&&m(e,n),(0,u.a)(Y,t),(0,u.t)(Y,Y),(0,d.m)(n.basis1,e.basis1,Y),(0,d.m)(n.basis2,e.basis2,Y),(0,d.m)((0,p.mJ)(n.plane),(0,p.mJ)(e.plane),Y),(0,d.m)(n.origin,e.origin,t),(0,p.T5)(n.plane,n.plane,n.origin),n},rotate:function(e,t,n,i){return e!==i&&m(e,i),(0,u.d)(q,t,n),(0,d.m)(i.basis1,e.basis1,q),(0,d.m)(i.basis2,e.basis2,q),Z(i),i},normal:x,UP:V},Symbol.toStringTag,{value:"Module"}))},46798:function(e,t,n){n.d(t,{q:function(){return h}});var i=n(37762),r=n(1413),a=n(15671),o=n(43144),s=n(63780),l=n(42537),u=n(32718),c=n(92026),d=n(66978),f=n(31009),v=u.Z.getLogger("esri.core.workers.WorkerHandle"),h=function(){function e(t,n,o,s){var l=this,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};(0,a.Z)(this,e),this._mainMethod=n,this._transferLists=o,this._listeners=[],this._promise=(0,f.bA)(t,(0,r.Z)((0,r.Z)({},u),{},{schedule:s})).then((function(e){if(void 0===l._thread){l._thread=e,l._promise=null,u.hasInitialize&&l.broadcast({},"initialize");var t,n=(0,i.Z)(l._listeners);try{for(n.s();!(t=n.n()).done;){var r=t.value;l._connectListener(r)}}catch(a){n.e(a)}finally{n.f()}}else e.close()})),this._promise.catch((function(e){return v.error("Failed to initialize ".concat(t," worker: ").concat(e))}))}return(0,o.Z)(e,[{key:"on",value:function(e,t){var n=this,i={removed:!1,eventName:e,callback:t,threadHandle:null};return this._listeners.push(i),this._connectListener(i),(0,l.kB)((function(){i.removed=!0,(0,s.Od)(n._listeners,i),n._thread&&(0,c.pC)(i.threadHandle)&&i.threadHandle.remove()}))}},{key:"destroy",value:function(){this._thread&&(this._thread.close(),this._thread=null),this._promise=null}},{key:"invoke",value:function(e,t){return this.invokeMethod(this._mainMethod,e,t)}},{key:"invokeMethod",value:function(e,t,n){var i=this;if(this._thread){var r=this._transferLists[e],a=r?r(t):[];return this._thread.invoke(e,t,{transferList:a,signal:n})}return this._promise?this._promise.then((function(){return(0,d.k_)(n),i.invokeMethod(e,t,n)})):Promise.reject(null)}},{key:"broadcast",value:function(e,t){var n=this;return this._thread?Promise.all(this._thread.broadcast(t,e)).then((function(){})):this._promise?this._promise.then((function(){return n.broadcast(e,t)})):Promise.reject()}},{key:"promise",get:function(){return this._promise}},{key:"_connectListener",value:function(e){this._thread&&this._thread.on(e.eventName,e.callback).then((function(t){e.removed||(e.threadHandle=t)}))}}]),e}()},85981:function(e,t,n){n.d(t,{AR:function(){return y},Gr:function(){return g},JG:function(){return u},Jk:function(){return f},KU:function(){return h},Ue:function(){return l},al:function(){return c},ct:function(){return p},nF:function(){return v},zk:function(){return d}});var i=n(16889),r=n(21530),a=n(11186),o=n(71353),s=n(11185);function l(e){return e?{origin:(0,o.a)(e.origin),vector:(0,o.a)(e.vector)}:{origin:(0,o.c)(),vector:(0,o.c)()}}function u(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:l();return c(e.origin,e.vector,t)}function c(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:l();return(0,a.c)(n.origin,e),(0,a.c)(n.vector,t),n}function d(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:l();return(0,a.c)(n.origin,e),(0,a.b)(n.vector,t,e),n}function f(e,t){var n=(0,a.b)(s.WM.get(),t,e.origin),r=(0,a.e)(e.vector,n),o=(0,a.e)(e.vector,e.vector),l=(0,i.uZ)(r/o,0,1),u=(0,a.b)(s.WM.get(),(0,a.g)(s.WM.get(),e.vector,l),n);return(0,a.e)(u,u)}function v(e,t,n){return p(e,t,0,1,n)}function h(e,t,n){return(0,a.a)(n,e.origin,(0,a.g)(n,e.vector,t))}function p(e,t,n,r,o){var l=e.vector,u=e.origin,c=(0,a.b)(s.WM.get(),t,u),d=(0,a.e)(l,c)/(0,a.p)(l);return(0,a.g)(o,l,(0,i.uZ)(d,n,r)),(0,a.a)(o,o,e.origin)}function g(e,t){if(b(e,function(e,t){var n=k.get();return n.origin=e,n.vector=t,n}(t.origin,t.direction),!1,w)){var n=w.tA,i=w.pB,r=w.distance2;if(n>=0&&n<=1)return r;if(n<0)return(0,a.d)(e.origin,i);if(n>1)return(0,a.d)((0,a.a)(s.WM.get(),e.origin,e.vector),i)}return null}function y(e,t,n){return!!b(e,t,!0,w)&&((0,a.c)(n,w.pA),!0)}function b(e,t,n,r){var o=1e-6,l=e.origin,u=(0,a.a)(s.WM.get(),l,e.vector),c=t.origin,d=(0,a.a)(s.WM.get(),c,t.vector),f=s.WM.get(),v=s.WM.get();if(f[0]=l[0]-c[0],f[1]=l[1]-c[1],f[2]=l[2]-c[2],v[0]=d[0]-c[0],v[1]=d[1]-c[1],v[2]=d[2]-c[2],Math.abs(v[0])<o&&Math.abs(v[1])<o&&Math.abs(v[2])<o)return!1;var h=s.WM.get();if(h[0]=u[0]-l[0],h[1]=u[1]-l[1],h[2]=u[2]-l[2],Math.abs(h[0])<o&&Math.abs(h[1])<o&&Math.abs(h[2])<o)return!1;var p=f[0]*v[0]+f[1]*v[1]+f[2]*v[2],g=v[0]*h[0]+v[1]*h[1]+v[2]*h[2],y=f[0]*h[0]+f[1]*h[1]+f[2]*h[2],b=v[0]*v[0]+v[1]*v[1]+v[2]*v[2],w=(h[0]*h[0]+h[1]*h[1]+h[2]*h[2])*b-g*g;if(Math.abs(w)<o)return!1;var k=(p*g-y*b)/w,_=(p+g*k)/b;n&&(k=(0,i.uZ)(k,0,1),_=(0,i.uZ)(_,0,1));var m=s.WM.get(),I=s.WM.get();return m[0]=l[0]+k*h[0],m[1]=l[1]+k*h[1],m[2]=l[2]+k*h[2],I[0]=c[0]+_*v[0],I[1]=c[1]+_*v[1],I[2]=c[2]+_*v[2],r.tA=k,r.tB=_,r.pA=m,r.pB=I,r.distance2=(0,a.d)(m,I),!0}var w={tA:0,tB:0,pA:(0,o.c)(),pB:(0,o.c)(),distance2:0},k=new r.x((function(){return{origin:null,vector:null}}))},84134:function(e,t,n){n.r(t),n.d(t,{FeatureServiceSnappingSource:function(){return ie}});var i=n(74165),r=n(1413),a=n(15861),o=n(15671),s=n(43144),l=n(60136),u=n(54062),c=n(27366),d=n(85015),f=n(41691),v=n(42537),h=n(92026),p=n(94172),g=n(49861),y=(n(63780),n(93169),n(25243),n(69912)),b=n(37762),w=n(11186),k=n(67077),_=n(82218);function m(e,t){return(0,_.g)(t.extent,I),(0,_.h)(I,(0,w.s)(Z,e.x,e.y,0))}var I=(0,_.c)(),Z=(0,k.c)(),S=n(69787),C=function(e){(0,l.Z)(n,e);var t=(0,u.Z)(n);function n(e){var i;return(0,o.Z)(this,n),(i=t.call(this,e)).pointOfInterest=null,i}return(0,s.Z)(n,[{key:"tiles",get:function(){var e=this.tilesCoveringView,t=(0,h.pC)(this.pointOfInterest)?this.pointOfInterest:this.view.center;return e.sort((function(e,n){return m(t,e)-m(t,n)})),e}},{key:"_scaleEnabled",value:function(){return(0,S.rs)(this.view.scale,this.layer.minScale||0,this.layer.maxScale||0)}},{key:"tilesCoveringView",get:function(){if(!this.view.ready||!this.view.featuresTilingScheme||!this.view.state||(0,h.Wi)(this.tileInfo))return[];if(!this._scaleEnabled)return[];var e,t=this.view.featuresTilingScheme.getTileCoverage(this.view.state,0),n=t.spans,i=t.lodInfo,r=i.level,a=[],o=(0,b.Z)(n);try{for(o.s();!(e=o.n()).done;)for(var s=e.value,l=s.row,u=s.colFrom,c=s.colTo,d=u;d<=c;d++){var f={id:null,level:r,row:l,col:i.normalizeCol(d)};this.tileInfo.updateTileInfo(f),a.push(f)}}catch(v){o.e(v)}finally{o.f()}return a}},{key:"tileInfo",get:function(){var e,t;return null!==(e=null===(t=this.view.featuresTilingScheme)||void 0===t?void 0:t.tileInfo)&&void 0!==e?e:null}},{key:"tileSize",get:function(){return(0,h.pC)(this.tileInfo)?this.tileInfo.size[0]:256}},{key:"initialize",value:function(){var e=this;this.own((0,p.YP)((function(){var t,n;return null===(t=e.view)||void 0===t||null===(n=t.state)||void 0===n?void 0:n.viewpoint}),(function(){return e.notifyChange("tilesCoveringView")}),p.Z_))}}]),n}(d.Z);(0,c._)([(0,g.Cb)({readOnly:!0})],C.prototype,"tiles",null),(0,c._)([(0,g.Cb)({readOnly:!0})],C.prototype,"_scaleEnabled",null),(0,c._)([(0,g.Cb)({readOnly:!0})],C.prototype,"tilesCoveringView",null),(0,c._)([(0,g.Cb)({readOnly:!0})],C.prototype,"tileInfo",null),(0,c._)([(0,g.Cb)({readOnly:!0})],C.prototype,"tileSize",null),(0,c._)([(0,g.Cb)({constructOnly:!0})],C.prototype,"view",void 0),(0,c._)([(0,g.Cb)({constructOnly:!0})],C.prototype,"layer",void 0),(0,c._)([(0,g.Cb)()],C.prototype,"pointOfInterest",void 0),C=(0,c._)([(0,y.j)("esri.views.interactive.snapping.featureSources.featureServiceSource.FeatureServiceTiles2D")],C);var M,O=n(29439),H=n(65156);!function(e){e[e.INVISIBLE=0]="INVISIBLE",e[e.VISIBLE_WHEN_EXTENDED=1]="VISIBLE_WHEN_EXTENDED",e[e.VISIBLE_ON_SURFACE=2]="VISIBLE_ON_SURFACE"}(M||(M={}));var T=function(e){(0,l.Z)(n,e);var t=(0,u.Z)(n);function n(e){var i;return(0,o.Z)(this,n),(i=t.call(this,e)).pointOfInterest=null,i}return(0,s.Z)(n,[{key:"tiles",get:function(){var e=this.tilesCoveringView,t=this.effectivePointOfInterest;if((0,h.pC)(t))for(var n=e.map((function(e){return m(t,e)})),i=1;i<n.length;i++)if(n[i-1]>n[i])return e.sort((function(e,n){return m(t,e)-m(t,n)})),e.slice();return e}},{key:"tilesCoveringView",get:function(){var e,t;return this._filterTiles(null===(e=this.view.featureTiles)||void 0===e||null===(t=e.tiles)||void 0===t?void 0:t.toArray()).map(P)}},{key:"tileInfo",get:function(){var e,t;return null!==(e=null===(t=this.view.featureTiles)||void 0===t?void 0:t.tilingScheme.toTileInfo())&&void 0!==e?e:null}},{key:"tileSize",get:function(){var e,t;return null!==(e=null===(t=this.view.featureTiles)||void 0===t?void 0:t.tileSize)&&void 0!==e?e:256}},{key:"effectivePointOfInterest",get:function(){var e,t=this.pointOfInterest;return(0,h.pC)(t)?t:null===(e=this.view.pointsOfInterest)||void 0===e?void 0:e.focus.location}},{key:"initialize",value:function(){var e=this;this.handles.add((0,p.YP)((function(){return e.view.featureTiles}),(function(t){e.handles.remove(N),t&&e.handles.add(t.addClient(),N)}),p.nn))}},{key:"_filterTiles",value:function(e){return(0,h.Wi)(e)?[]:e.filter((function(e){return Math.abs(e.measures.screenRect[3]-e.measures.screenRect[1])>E&&e.measures.visibility===M.VISIBLE_ON_SURFACE}))}}]),n}(f.r);function P(e){var t=(0,O.Z)(e.lij,3),n=t[0],i=t[1],r=t[2],a=e.extent;return{id:"".concat(n,"/").concat(i,"/").concat(r),level:n,row:i,col:r,extent:a}}(0,c._)([(0,g.Cb)({readOnly:!0})],T.prototype,"tiles",null),(0,c._)([(0,g.Cb)({readOnly:!0})],T.prototype,"tilesCoveringView",null),(0,c._)([(0,g.Cb)({readOnly:!0})],T.prototype,"tileInfo",null),(0,c._)([(0,g.Cb)({readOnly:!0})],T.prototype,"tileSize",null),(0,c._)([(0,g.Cb)({constructOnly:!0})],T.prototype,"view",void 0),(0,c._)([(0,g.Cb)()],T.prototype,"pointOfInterest",void 0),(0,c._)([(0,g.Cb)()],T.prototype,"effectivePointOfInterest",null),T=(0,c._)([(0,y.j)("esri.views.interactive.snapping.featureSources.featureServiceSource.FeatureServiceTiles3D")],T);var E=50,N="feature-tiles",W=n(69117),x=n(100),R=n(80885),F=n(51995),z=n(52639),A=n(16889),j=n(62554),V=n(61459),L=n(58009),U=n(87037),J=[[0,179,255],[117,62,128],[0,104,255],[215,189,166],[32,0,193],[98,162,206],[102,112,129],[52,125,0],[142,118,246],[138,83,0],[92,122,255],[122,55,83],[0,142,255],[81,40,179],[0,200,244],[13,24,127],[0,170,147],[19,58,241],[22,44,35]],B=function(e){(0,l.Z)(n,e);var t=(0,u.Z)(n);function n(e){var i;return(0,o.Z)(this,n),(i=t.call(this,e)).updating=!1,i.enablePolygons=!0,i.enableLabels=!0,i._polygons=new Map,i._labels=new Map,i._enabled=!0,i}return(0,s.Z)(n,[{key:"initialize",value:function(){this._symbols=J.map((function(e){return new V.default({color:[e[0],e[1],e[2],.6],outline:{color:"black",width:1}})})),this.update()}},{key:"destroy",value:function(){this._enabled=!1,this.clear()}},{key:"enabled",get:function(){return this._enabled},set:function(e){this._enabled!==e&&(this._enabled=e,this.update())}},{key:"update",value:function(){var e=this;if(this._enabled){var t=this.getTiles(),n=new Array,i=new Set((this._labels.size,this._labels.keys()));t.forEach((function(r,a){var o=r.lij.toString();i.delete(o);var s=r.lij[0],l=r.geometry;if(e.enablePolygons&&!e._polygons.has(o)){var u=new z.Z({geometry:l,symbol:e._symbols[s%e._symbols.length]});e._polygons.set(o,u),n.push(u)}if(e.enableLabels){var c=function(e){if((0,h.pC)(e.label))return e.label;var t=e.lij.toString();return(0,h.pC)(e.loadPriority)&&(t+=" (".concat(e.loadPriority,")")),t}(r),d=a/(t.length-1),f=(0,A.t7)(0,200,d),v=(0,A.t7)(20,6,d)/.75,p=(0,h.pC)(r.loadPriority)&&r.loadPriority>=t.length,g=new F.Z([f,p?0:f,p?0:f]),y="3d"===e.view.type?function(){return new j.Z({verticalOffset:{screenLength:40/.75},callout:{type:"line",color:"white",border:{color:"black"}},symbolLayers:[new U.Z({text:c,halo:{color:"white",size:1/.75},material:{color:g},size:v})]})}:function(){return new L.Z({text:c,haloColor:"white",haloSize:1/.75,color:g,size:v})};if(e._labels.has(o)){var b=e._labels.get(o),w=y();((0,h.Wi)(b.symbol)||JSON.stringify(w)!==JSON.stringify(b.symbol))&&(b.symbol=w)}else{var k=new z.Z({geometry:l.extent.center,symbol:y()});e._labels.set(o,k),n.push(k)}}}));var r=new Array;i.forEach((function(t){e._polygons.has(t)&&(r.push(e._polygons.get(t)),e._polygons.delete(t)),e._labels.has(t)&&(r.push(e._labels.get(t)),e._labels.delete(t))})),this.view.graphics.removeMany(r),this.view.graphics.addMany(n)}else this.clear()}},{key:"clear",value:function(){this.view.graphics.removeMany(Array.from(this._polygons.values())),this.view.graphics.removeMany(Array.from(this._labels.values())),this._polygons.clear(),this._labels.clear()}}]),n}(d.Z);(0,c._)([(0,g.Cb)({constructOnly:!0})],B.prototype,"view",void 0),(0,c._)([(0,g.Cb)({readOnly:!0})],B.prototype,"updating",void 0),(0,c._)([(0,g.Cb)()],B.prototype,"enabled",null);var D=function(e){(0,l.Z)(n,e);var t=(0,u.Z)(n);function n(e){var i;return(0,o.Z)(this,n),(i=t.call(this,e)).handles=new x.Z,i}return(0,s.Z)(n,[{key:"initialize",value:function(){var e=this,t=setInterval((function(){return e._fetchDebugInfo()}),2e3);this.handles.add((0,v.kB)((function(){return clearInterval(t)})))}},{key:"destroy",value:function(){this.handles.destroy()}},{key:"getTiles",value:function(){var e=this;if(!this.debugInfo)return[];var t=new Map,n=new Map;this.debugInfo.storedTiles.forEach((function(e){t.set(e.data.id,e.featureCount)})),this.debugInfo.pendingTiles.forEach((function(e){t.set(e.data.id,e.featureCount),n.set(e.data.id,e.state)}));var i=function(e){var i,r=n.get(e),a=null!==(i=t.get(e))&&void 0!==i?i:"?";return r?"".concat(r,":").concat(a,"\n").concat(e):"store:".concat(a,"\n").concat(e)},r=new Map;return this.debugInfo.storedTiles.forEach((function(e){r.set(e.data.id,e.data)})),this.debugInfo.pendingTiles.forEach((function(e){r.set(e.data.id,e.data)})),Array.from(r.values()).map((function(t){return{lij:[t.level,t.row,t.col],geometry:R.Z.fromExtent((0,H.HH)(t.extent,e.view.spatialReference)),label:i(t.id)}}))}},{key:"_fetchDebugInfo",value:function(){var e=this;this.handle.getDebugInfo(null).then((function(t){e.debugInfo=t,e.update()}))}}]),n}(B=(0,c._)([(0,y.j)("esri.views.support.TileTreeDebugger")],B));(0,c._)([(0,g.Cb)({constructOnly:!0})],D.prototype,"handle",void 0),D=(0,c._)([(0,y.j)("esri.views.interactive.snapping.featureSources.WorkerTileTreeDebugger")],D);var Y=n(66978),q=n(46798),X=n(27823),G=function(e){(0,l.Z)(n,e);var t=(0,u.Z)(n);function n(e){var i;return(0,o.Z)(this,n),(i=t.call(this,e)).availability=0,i.workerHandleUpdating=!0,i.editId=0,i}return(0,s.Z)(n,[{key:"updating",get:function(){return this.updatingHandles.updating||this.workerHandleUpdating}},{key:"destroy",value:function(){this.workerHandle.destroy()}},{key:"initialize",value:function(){var e=this;this.workerHandle=new Q(this.schedule),this.handles.add([this.workerHandle.on("notify-updating",(function(t){var n=t.updating;return e.workerHandleUpdating=n})),this.workerHandle.on("notify-availability",(function(t){var n=t.availability;return e._set("availability",n)}))])}},{key:"setup",value:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(t,n){var r,a;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this._serviceInfoFromLayer(t.layer),!(0,h.Wi)(r)){e.next=3;break}return e.abrupt("return");case 3:return a={configuration:this._convertConfiguration(t.configuration),serviceInfo:r,spatialReference:t.spatialReference.toJSON()},e.next=6,this.updatingHandles.addPromise(this.workerHandle.invokeMethod("setup",a,n));case 6:this.updatingHandles.addPromise(this.workerHandle.invokeMethod("whenNotUpdating",{},n));case 7:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"configure",value:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(t,n){var r;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this._convertConfiguration(t),e.next=3,this.updatingHandles.addPromise(this.workerHandle.invokeMethod("configure",r,n));case 3:this.updatingHandles.addPromise(this.workerHandle.invokeMethod("whenNotUpdating",{},n));case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"refresh",value:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(t){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.updatingHandles.addPromise(this.workerHandle.invokeMethod("refresh",{},t));case 2:this.updatingHandles.addPromise(this.workerHandle.invokeMethod("whenNotUpdating",{},t));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"fetchCandidates",value:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(t,n){var r;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={distance:t.distance,point:t.coordinateHelper.vectorToPoint(t.point).toJSON(),types:t.types,filter:(0,h.pC)(t.filter)?t.filter.createQuery().toJSON():null},e.abrupt("return",this.workerHandle.invoke(r,n));case 2:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"updateTiles",value:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(t,n){var r;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={tiles:t.tiles,tileInfo:(0,h.pC)(t.tileInfo)?t.tileInfo.toJSON():null,tileSize:t.tileSize},e.next=3,this.updatingHandles.addPromise(this.workerHandle.invokeMethod("updateTiles",r,n));case 3:this.updatingHandles.addPromise(this.workerHandle.invokeMethod("whenNotUpdating",{},n));case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"applyEdits",value:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(t,n){var r,a,o,s,l,u,c,d,f,v;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=this.editId++,d={id:c},e.next=3,this.updatingHandles.addPromise(this.workerHandle.invokeMethod("beginApplyEdits",d,n));case 3:return e.next=5,this.updatingHandles.addPromise((0,Y.Hl)(t.result,n));case 5:return f=e.sent,v={id:c,edits:{addedFeatures:null!==(r=null===(a=f.addedFeatures)||void 0===a?void 0:a.map((function(e){return e.objectId})))&&void 0!==r?r:[],deletedFeatures:null!==(o=null===(s=f.deletedFeatures)||void 0===s?void 0:s.map((function(e){return{objectId:e.objectId,globalId:e.globalId}})))&&void 0!==o?o:[],updatedFeatures:null!==(l=null===(u=f.updatedFeatures)||void 0===u?void 0:u.map((function(e){return e.objectId})))&&void 0!==l?l:[]}},e.next=9,this.updatingHandles.addPromise(this.workerHandle.invokeMethod("endApplyEdits",v,n));case 9:this.updatingHandles.addPromise(this.workerHandle.invokeMethod("whenNotUpdating",{},n));case 10:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getDebugInfo",value:function(e){return this.workerHandle.invokeMethod("getDebugInfo",{},e)}},{key:"_convertConfiguration",value:function(e){return{filter:(0,h.pC)(e.filter)?e.filter.toJSON():null,customParameters:e.customParameters}}},{key:"_serviceInfoFromLayer",value:function(e){var t;return"multipatch"===e.geometryType||"mesh"===e.geometryType?null:{url:e.parsedUrl.path,fields:e.fields.map((function(e){return e.toJSON()})),geometryType:X.Mk.toJSON(e.geometryType),capabilities:e.capabilities,objectIdField:e.objectIdField,globalIdField:e.globalIdField,spatialReference:e.spatialReference.toJSON(),timeInfo:null===(t=e.timeInfo)||void 0===t?void 0:t.toJSON()}}}]),n}(f.r);(0,c._)([(0,g.Cb)({constructOnly:!0})],G.prototype,"schedule",void 0),(0,c._)([(0,g.Cb)({readOnly:!0})],G.prototype,"updating",null),(0,c._)([(0,g.Cb)({readOnly:!0})],G.prototype,"availability",void 0),(0,c._)([(0,g.Cb)()],G.prototype,"workerHandleUpdating",void 0),G=(0,c._)([(0,y.j)("esri.views.interactive.snapping.featureSources.featureServiceSource.FeatureServiceSnappingSourceWorkerHandle")],G);var Q=function(e){(0,l.Z)(n,e);var t=(0,u.Z)(n);function n(e){return(0,o.Z)(this,n),t.call(this,"FeatureServiceSnappingSourceWorker","fetchCandidates",{},e,{strategy:"dedicated"})}return(0,s.Z)(n)}(q.q),K=n(7882),$=n(59068),ee=n(22824),te=function(e){(0,l.Z)(n,e);var t=(0,u.Z)(n);function n(e){var i;return(0,o.Z)(this,n),(i=t.call(this,e)).pointOfInterest=null,i}return(0,s.Z)(n,[{key:"tiles",get:function(){return[{id:"0/0/0",level:0,row:0,col:0,extent:(0,H.al)(-1e8,-1e8,1e8,1e8)}]}},{key:"tileInfo",get:function(){return new ee.Z({origin:new K.Z({x:-1e8,y:1e8,spatialReference:this.layer.spatialReference}),size:[512,512],lods:[new $.Z({level:0,scale:1,resolution:390625})],spatialReference:this.layer.spatialReference})}},{key:"tileSize",get:function(){return this.tileInfo.size[0]}}]),n}(d.Z);(0,c._)([(0,g.Cb)({readOnly:!0})],te.prototype,"tiles",null),(0,c._)([(0,g.Cb)({readOnly:!0})],te.prototype,"tileInfo",null),(0,c._)([(0,g.Cb)({readOnly:!0})],te.prototype,"tileSize",null),(0,c._)([(0,g.Cb)({constructOnly:!0})],te.prototype,"layer",void 0),(0,c._)([(0,g.Cb)()],te.prototype,"pointOfInterest",void 0),te=(0,c._)([(0,y.j)("esri.views.interactive.snapping.featureSources.featureServiceSource.FeatureServiceTilesSimple")],te);var ne=n(32609),ie=function(e){(0,l.Z)(n,e);var t=(0,u.Z)(n);function n(e){return(0,o.Z)(this,n),t.call(this,e)}return(0,s.Z)(n,[{key:"updateTilesParameters",get:function(){return{tiles:this.tilesOfInterest.tiles,tileInfo:this.tilesOfInterest.tileInfo,tileSize:this.tilesOfInterest.tileSize}}},{key:"updating",get:function(){return this.workerHandle.updating||this.updatingHandles.updating}},{key:"configuration",get:function(){return{filter:this.layer.createQuery(),customParameters:this.layer.customParameters}}},{key:"availability",get:function(){return this.workerHandle.availability}},{key:"layer",get:function(){return this.layerSource.layer}},{key:"initialize",value:function(){var e=this,t=this.view;if((0,h.pC)(t))switch(t.type){case"2d":this.tilesOfInterest=new C({view:t,layer:this.layer}),this.workerHandle=new G;break;case"3d":var n=t.resourceController;this.tilesOfInterest=new T({view:t}),this.workerHandle=new G({schedule:function(e){return n.schedule(e)}})}else this.tilesOfInterest=new te({layer:this.layer}),this.workerHandle=new G;this.handles.add([(0,v.ed)(this.workerHandle)]),this.workerHandle.setup({layer:this.layer,spatialReference:this.spatialReference,configuration:this.configuration},null),this.updatingHandles.add((function(){return e.updateTilesParameters}),(function(){return e.workerHandle.updateTiles(e.updateTilesParameters,null)}),p.nn),this.handles.add([(0,p.YP)((function(){return e.configuration}),(function(t){return e.workerHandle.configure(t,null)}),p.Z_)]),(0,h.pC)(t)&&this.handles.add((0,p.YP)((function(){return ne.Z.FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES}),(function(n){n&&!e.debug?(e.debug=new D({view:t,handle:e.workerHandle}),e.handles.add((0,v.ed)(e.debug),"debug")):!n&&e.debug&&e.handles.remove("debug")}),p.nn)),this.handles.add(this.layerSource.layer.on("apply-edits",(function(t){e.workerHandle.applyEdits(t,null)})))}},{key:"refresh",value:function(){this.workerHandle.refresh(null)}},{key:"fetchCandidates",value:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(t,n){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.tilesOfInterest.pointOfInterest=t.coordinateHelper.vectorToPoint(t.point),e.next=3,this.workerHandle.fetchCandidates((0,r.Z)((0,r.Z)({},t),{},{filter:null}),n);case 3:return e.abrupt("return",e.sent.candidates.map((function(e){return(0,W.X)(e,t.coordinateHelper,t.elevationInfo)})));case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getDebugInfo",value:function(e){return this.workerHandle.getDebugInfo(e)}}]),n}((0,f.p)(d.Z));(0,c._)([(0,g.Cb)({constructOnly:!0})],ie.prototype,"spatialReference",void 0),(0,c._)([(0,g.Cb)({constructOnly:!0})],ie.prototype,"layerSource",void 0),(0,c._)([(0,g.Cb)({constructOnly:!0})],ie.prototype,"view",void 0),(0,c._)([(0,g.Cb)()],ie.prototype,"tilesOfInterest",void 0),(0,c._)([(0,g.Cb)({readOnly:!0})],ie.prototype,"updateTilesParameters",null),(0,c._)([(0,g.Cb)({readOnly:!0})],ie.prototype,"updating",null),(0,c._)([(0,g.Cb)({readOnly:!0})],ie.prototype,"configuration",null),(0,c._)([(0,g.Cb)({readOnly:!0})],ie.prototype,"availability",null),ie=(0,c._)([(0,y.j)("esri.views.interactive.snapping.featureSources.FeatureServiceSnappingSource")],ie)},69117:function(e,t,n){n.d(t,{X:function(){return v}});var i=n(95905),r=n(1413),a=n(15671),o=n(43144),s=n(60136),l=n(54062),u=n(95122),c=n(75691),d=n(61309),f=function(e){(0,s.Z)(n,e);var t=(0,l.Z)(n);function n(e){return(0,a.Z)(this,n),t.call(this,(0,r.Z)((0,r.Z)({},e),{},{constraint:new u.Hk(e.coordinateHelper,e.targetPoint)}))}return(0,o.Z)(n,[{key:"hints",get:function(){return[new d.n(this.targetPoint,this.elevationInfo)]}}]),n}(c.a);function v(e,t,n){switch(e.type){case"edge":return new i.L({coordinateHelper:t,edgeStart:t.pointToVector(e.start),edgeEnd:t.pointToVector(e.end),targetPoint:t.pointToVector(e.target),objectId:e.objectId,elevationInfo:n});case"vertex":return new f({coordinateHelper:t,targetPoint:t.pointToVector(e.target),objectId:e.objectId,elevationInfo:n})}}},61309:function(e,t,n){n.d(t,{n:function(){return l}});var i=n(15671),r=n(43144),a=n(60136),o=n(54062),s=n(64674),l=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(e,r){var a;return(0,i.Z)(this,n),(a=t.call(this,r)).point=e,a}return(0,r.Z)(n,[{key:"equals",value:function(e){return e instanceof n&&(0,s.Xv)(this.point,e.point)}}]),n}(n(55054).r)}}]);
//# sourceMappingURL=4134.3bae8614.chunk.js.map