"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[718],{718:function(e,t,n){n.r(t),n.d(t,{registerFunctions:function(){return R}});var r=n(74165),a=n(37762),i=n(15861),s=n(72741),l=n(62357),c=n(5431),u=n(97879),o=n(31786),f=n(790),d=n(97246),p=n(44715),y=n(12829),b=n(67820),h=n(89066),m=n(45184),x=n(73954),g=n(84272),v=n(82279),k=n(29876),w=n(65247),F=n(93106),E=n(66978),I=n(48562),Z=n(56428),D=n(83040);function N(e,t,n,r){if(1===r.length){if((0,p.l)(r[0]))return(0,F.t)(e,r[0],-1);if((0,p.n)(r[0]))return(0,F.t)(e,r[0].toArray(),-1)}return(0,F.t)(e,r,-1)}function A(e,t,n){return S.apply(this,arguments)}function S(){return(S=(0,i.Z)((0,r.Z)().mark((function e(t,n,a){var i,s,l,c,u,o;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!((i=t.getVariables()).length>0)){e.next=17;break}s=[],l=0;case 4:if(!(l<i.length)){e.next=14;break}return c={name:i[l]},e.t0=s,e.next=9,n.evaluateIdentifier(a,c);case 9:e.t1=e.sent,e.t0.push.call(e.t0,e.t1);case 11:l++,e.next=4;break;case 14:for(u={},o=0;o<i.length;o++)u[i[o]]=s[o];return e.abrupt("return",(t.parameters=u,t));case 17:return e.abrupt("return",t);case 18:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function C(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;for(var r in e)if(r.toLowerCase()===t.toLowerCase())return e[r];return n}function T(e){if(null===e)return null;var t={type:C(e,"type",""),name:C(e,"name","")};if("range"===t.type)t.range=C(e,"range",[]);else{t.codedValues=[];var n,r=(0,a.Z)(C(e,"codedValues",[]));try{for(r.s();!(n=r.n()).done;){var i=n.value;t.codedValues.push({name:C(i,"name",""),code:C(i,"code",null)})}}catch(s){r.e(s)}finally{r.f()}}return t}function L(e){if(null===e)return null;var t={},n=C(e,"wkt",null);null!==n&&(t.wkt=n);var r=C(e,"wkid",null);return null!==r&&(t.wkid=r),t}function O(e){if(null===e)return null;var t={hasZ:C(e,"hasz",!1),hasM:C(e,"hasm",!1)},n=C(e,"spatialreference",null);n&&(t.spatialReference=L(n));var r=C(e,"x",null);if(null!==r)return t.x=r,t.y=C(e,"y",null),t;var a=C(e,"rings",null);if(null!==a)return t.rings=a,t;var i=C(e,"paths",null);if(null!==i)return t.paths=i,t;var s=C(e,"points",null);if(null!==s)return t.points=s,t;for(var l=0,c=["xmin","xmax","ymin","ymax","zmin","zmax","mmin","mmax"];l<c.length;l++){var u=c[l],o=C(e,u,null);null!==o&&(t[u]=o)}return t}function P(e){return!!e.layerDefinition&&!!e.featureSet&&!1!==function(e,t){var n,r=(0,a.Z)(t);try{for(r.s();!(n=r.n()).done;)if(n.value===e)return!0}catch(i){r.e(i)}finally{r.f()}return!1}(e.layerDefinition.geometryType,["","esriGeometryPoint","esriGeometryPolyline","esriGeometryPolygon","esriGeometryMultipoint","esriGeometryEnvelope"])&&null!==e.layerDefinition.objectIdField&&""!==e.layerDefinition.objectIdField&&!1!==(0,p.l)(e.layerDefinition.fields)&&!1!==(0,p.l)(e.featureSet.features)}function R(e){"async"===e.mode&&(e.functions.getuser=function(t,n){return e.standardFunctionAsync(t,n,function(){var e=(0,i.Z)((0,r.Z)().mark((function e(n,a,i){var c,u,f,d,y,b,h,m,x,g,v,k,w,F,E,I,Z;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((0,p.p)(i,1,2),c=(0,p.C)(i[1],""),u=!0===c,c=!0===c||!1===c?"":(0,p.h)(c),!(i[0]instanceof s.Z)){e.next=13;break}return f=null,t.services&&t.services.portal&&(f=t.services.portal),f=(0,o.getPortal)(i[0],f),e.next=7,(0,o.lookupUser)(f,c,u);case 7:if(!(d=e.sent)){e.next=12;break}for(y=JSON.parse(JSON.stringify(d)),b=0,h=["lastLogin","created","modified"];b<h.length;b++)void 0!==y[m=h[b]]&&null!==y[m]&&(y[m]=new Date(y[m]));return e.abrupt("return",l.Z.convertObjectToArcadeDictionary(y));case 12:case 28:case 38:return e.abrupt("return",null);case 13:if(x=null,(0,p.y)(i[0])&&(x=i[0]),!x){e.next=39;break}if(u=!1,!c){e.next=17;break}return e.abrupt("return",null);case 17:return e.next=19,x.load();case 19:return e.next=21,x.getOwningSystemUrl();case 21:if(g=e.sent){e.next=29;break}if(c){e.next=28;break}return e.next=26,x.getIdentityUser();case 26:return v=e.sent,e.abrupt("return",v?l.Z.convertObjectToArcadeDictionary({username:v}):null);case 29:return k=null,t.services&&t.services.portal&&(k=t.services.portal),k=(0,o.getPortal)(new s.Z(g),k),e.next=33,(0,o.lookupUser)(k,c,u);case 33:if(!(w=e.sent)){e.next=38;break}for(F=JSON.parse(JSON.stringify(w)),E=0,I=["lastLogin","created","modified"];E<I.length;E++)void 0!==F[Z=I[E]]&&null!==F[Z]&&(F[Z]=new Date(F[Z]));return e.abrupt("return",l.Z.convertObjectToArcadeDictionary(F));case 39:throw new Error("Invalid Parameter");case 40:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}())},e.signatures.push({name:"getuser",min:"1",max:"2"}),e.functions.featuresetbyid=function(t,n){return e.standardFunctionAsync(t,n,(function(e,t,n){if((0,p.p)(n,2,4),n[0]instanceof u.Z){var r=(0,p.h)(n[1]),a=(0,p.C)(n[2],null),i=(0,p.g)((0,p.C)(n[3],!0));if(null===a&&(a=["*"]),!1===(0,p.l)(a))throw new Error("Invalid Parameter");return n[0].featureSetById(r,i,a)}throw new Error("Invalid Parameter")}))},e.signatures.push({name:"featuresetbyid",min:"2",max:"4"}),e.functions.getfeatureset=function(t,n){return e.standardFunctionAsync(t,n,(function(e,n,r){if((0,p.p)(r,1,2),(0,p.s)(r[0])){var a=(0,p.C)(r[1],"datasource");return null===a&&(a="datasource"),a=(0,p.h)(a).toLowerCase(),(0,o.convertToFeatureSet)(r[0].fullSchema(),a,t.lrucache,t.interceptor,t.spatialReference)}throw new Error("Invalid Parameter")}))},e.signatures.push({name:"getfeatureset",min:"1",max:"2"}),e.functions.featuresetbyportalitem=function(t,n){return e.standardFunctionAsync(t,n,(function(e,n,r){if((0,p.p)(r,2,5),null===r[0])throw new Error("Portal is required");if(r[0]instanceof s.Z){var a=(0,p.h)(r[1]),i=(0,p.h)(r[2]),l=(0,p.C)(r[3],null),c=(0,p.g)((0,p.C)(r[4],!0));if(null===l&&(l=["*"]),!1===(0,p.l)(l))throw new Error("Invalid Parameter");var u=null;return t.services&&t.services.portal&&(u=t.services.portal),u=(0,o.getPortal)(r[0],u),(0,o.constructFeatureSetFromPortalItem)(a,i,t.spatialReference,l,c,u,t.lrucache,t.interceptor)}if(!1===(0,p.b)(r[0]))throw new Error("Portal is required");var f=(0,p.h)(r[0]),d=(0,p.h)(r[1]),y=(0,p.C)(r[2],null),b=(0,p.g)((0,p.C)(r[3],!0));if(null===y&&(y=["*"]),!1===(0,p.l)(y))throw new Error("Invalid Parameter");if(t.services&&t.services.portal)return(0,o.constructFeatureSetFromPortalItem)(f,d,t.spatialReference,y,b,t.services.portal,t.lrucache,t.interceptor);throw new Error("Portal is required")}))},e.signatures.push({name:"featuresetbyportalitem",min:"2",max:"5"}),e.functions.featuresetbyname=function(t,n){return e.standardFunctionAsync(t,n,(function(e,t,n){if((0,p.p)(n,2,4),n[0]instanceof u.Z){var r=(0,p.h)(n[1]),a=(0,p.C)(n[2],null),i=(0,p.g)((0,p.C)(n[3],!0));if(null===a&&(a=["*"]),!1===(0,p.l)(a))throw new Error("Invalid Parameter");return n[0].featureSetByName(r,i,a)}throw new Error("Invalid Parameter")}))},e.signatures.push({name:"featuresetbyname",min:"2",max:"4"}),e.functions.featureset=function(t,n){return e.standardFunction(t,n,(function(e,n,r){(0,p.p)(r,1,1);var i=r[0],s={layerDefinition:{geometryType:"",objectIdField:"",globalIdField:"",typeIdField:"",fields:[]},featureSet:{geometryType:"",features:[]}};if((0,p.b)(i))void 0!==(i=JSON.parse(i)).layerDefinition?(s.layerDefinition=i.layerDefinition,s.featureSet=i.featureSet,i.layerDefinition.spatialReference&&(s.layerDefinition.spatialReference=i.layerDefinition.spatialReference)):(s.featureSet.features=i.features,s.featureSet.geometryType=i.geometryType,s.layerDefinition.geometryType=s.featureSet.geometryType,s.layerDefinition.objectIdField=i.objectIdFieldName,s.layerDefinition.typeIdField=i.typeIdFieldName,s.layerDefinition.globalIdField=i.globalIdFieldName,s.layerDefinition.fields=i.fields,i.spatialReference&&(s.layerDefinition.spatialReference=i.spatialReference));else{if(!(r[0]instanceof l.Z))throw new Error("Invalid Parameter");var c=C(i=JSON.parse(r[0].castToText()),"layerdefinition");if(null!==c){s.layerDefinition.geometryType=C(c,"geometrytype",""),s.featureSet.geometryType=s.layerDefinition.geometryType,s.layerDefinition.globalIdField=C(c,"globalidfield",""),s.layerDefinition.objectIdField=C(c,"objectidfield",""),s.layerDefinition.typeIdField=C(c,"typeidfield","");var u=C(c,"spatialreference",null);u&&(s.layerDefinition.spatialReference=L(u));var o,f=(0,a.Z)(C(c,"fields",[]));try{for(f.s();!(o=f.n()).done;){var d=o.value,y={name:C(d,"name",""),alias:C(d,"alias",""),type:C(d,"type",""),nullable:C(d,"nullable",!0),editable:C(d,"editable",!0),length:C(d,"length",null),domain:T(C(d,"domain"))};s.layerDefinition.fields.push(y)}}catch(U){f.e(U)}finally{f.f()}var b=C(i,"featureset",null);if(b){var h,m={},x=(0,a.Z)(s.layerDefinition.fields);try{for(x.s();!(h=x.n()).done;){var v=h.value;m[v.name.toLowerCase()]=v.name}}catch(U){x.e(U)}finally{x.f()}var k,w=(0,a.Z)(C(b,"features",[]));try{for(w.s();!(k=w.n()).done;){var F=k.value,E={},I=C(F,"attributes",{});for(var Z in I)E[m[Z.toLowerCase()]]=I[Z];s.featureSet.features.push({attributes:E,geometry:O(C(F,"geometry",null))})}}catch(U){w.e(U)}finally{w.f()}}}else{s.layerDefinition.geometryType=C(i,"geometrytype",""),s.featureSet.geometryType=s.layerDefinition.geometryType,s.layerDefinition.objectIdField=C(i,"objectidfieldname",""),s.layerDefinition.typeIdField=C(i,"typeidfieldname","");var D=C(i,"spatialreference",null);D&&(s.layerDefinition.spatialReference=L(D));var N,A=(0,a.Z)(C(i,"fields",[]));try{for(A.s();!(N=A.n()).done;){var S=N.value,R={name:C(S,"name",""),alias:C(S,"alias",""),type:C(S,"type",""),nullable:C(S,"nullable",!0),editable:C(S,"editable",!0),length:C(S,"length",null),domain:T(C(S,"domain"))};s.layerDefinition.fields.push(R)}}catch(U){A.e(U)}finally{A.f()}var W,M={},G=(0,a.Z)(s.layerDefinition.fields);try{for(G.s();!(W=G.n()).done;){var j=W.value;M[j.name.toLowerCase()]=j.name}}catch(U){G.e(U)}finally{G.f()}var B,V=(0,a.Z)(C(i,"features",[]));try{for(V.s();!(B=V.n()).done;){var H=B.value,X={},z=C(H,"attributes",{});for(var J in z)X[M[J.toLowerCase()]]=z[J];s.featureSet.features.push({attributes:X,geometry:O(C(H,"geometry",null))})}}catch(U){V.e(U)}finally{V.f()}}}if(!1===P(s))throw new Error("Invalid Parameter");return g.Z.create(s,t.spatialReference)}))},e.signatures.push({name:"featureset",min:"1",max:"1"}),e.functions.filter=function(t,n){return e.standardFunctionAsync(t,n,function(){var n=(0,i.Z)((0,r.Z)().mark((function n(i,s,l){var c,u,o,y,h,m,x,g,v,k,w,F,Z,D,N;return(0,r.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if((0,p.p)(l,2,2),!(0,p.l)(l[0])&&!(0,p.n)(l[0])){n.next=44;break}if(c=[],(u=l[0])instanceof d.Z&&(u=u.toArray()),o=null,!(l[1]instanceof f.Z)){n.next=9;break}o=e.arcadeCustomFunctionHandler(l[1]),n.next=16;break;case 9:if(!(l[1]instanceof p.N)){n.next=13;break}o=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return l[1].fn(t,{preparsed:!0,arguments:n})},n.next=16;break;case 13:if(l[1]instanceof p.S){n.next=15;break}throw new Error("Invalid Parameter");case 15:o=function(){var e;if(arguments.length!==l[1].paramCount)throw new Error("Invalid parameters");return(e=l[1]).fn.apply(e,arguments)};case 16:y=(0,a.Z)(u),n.prev=17,y.s();case 19:if((h=y.n()).done){n.next=35;break}if(m=h.value,x=o(m),!(0,E.y8)(x)){n.next=32;break}return n.t0=!0,n.next=26,x;case 26:if(n.t1=n.sent,n.t2=n.t0===n.t1,!n.t2){n.next=30;break}c.push(m);case 30:n.next=33;break;case 32:!0===x&&c.push(m);case 33:n.next=19;break;case 35:n.next=40;break;case 37:n.prev=37,n.t3=n.catch(17),y.e(n.t3);case 40:return n.prev=40,y.f(),n.finish(40);case 43:return n.abrupt("return",c);case 44:if(!(0,p.y)(l[0])){n.next=67;break}return n.next=47,l[0].load();case 47:if(g=n.sent,v=I.WhereClause.create(l[1],g.getFieldsIndex()),!((k=v.getVariables()).length>0)){n.next=66;break}w=[],F=0;case 53:if(!(F<k.length)){n.next=63;break}return Z={name:k[F]},n.t4=w,n.next=58,e.evaluateIdentifier(t,Z);case 58:n.t5=n.sent,n.t4.push.call(n.t4,n.t5);case 60:F++,n.next=53;break;case 63:for(D={},N=0;N<k.length;N++)D[k[N]]=w[N];return n.abrupt("return",(v.parameters=D,new b.Z({parentfeatureset:l[0],whereclause:v})));case 66:return n.abrupt("return",new b.Z({parentfeatureset:l[0],whereclause:v}));case 67:throw new Error("Filter cannot accept this parameter type");case 68:case"end":return n.stop()}}),n,null,[[17,37,40,43]])})));return function(e,t,r){return n.apply(this,arguments)}}())},e.signatures.push({name:"filter",min:"2",max:"2"}),e.functions.orderby=function(t,n){return e.standardFunctionAsync(t,n,function(){var e=(0,i.Z)((0,r.Z)().mark((function e(t,n,a){var i;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((0,p.p)(a,2,2),!(0,p.y)(a[0])){e.next=3;break}return i=new v.Z(a[1]),e.abrupt("return",new h.Z({parentfeatureset:a[0],orderbyclause:i}));case 3:throw new Error("Order cannot accept this parameter type");case 4:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}())},e.signatures.push({name:"orderby",min:"2",max:"2"}),e.functions.top=function(t,n){return e.standardFunctionAsync(t,n,function(){var e=(0,i.Z)((0,r.Z)().mark((function e(t,n,a){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((0,p.p)(a,2,2),!(0,p.y)(a[0])){e.next=2;break}return e.abrupt("return",new m.Z({parentfeatureset:a[0],topnum:a[1]}));case 2:if(!(0,p.l)(a[0])){e.next=4;break}return e.abrupt("return",(0,p.f)(a[1])>=a[0].length?a[0].slice(0):a[0].slice(0,(0,p.f)(a[1])));case 4:if(!(0,p.n)(a[0])){e.next=6;break}return e.abrupt("return",(0,p.f)(a[1])>=a[0].length()?a[0].slice(0):a[0].slice(0,(0,p.f)(a[1])));case 6:throw new Error("Top cannot accept this parameter type");case 7:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}())},e.signatures.push({name:"top",min:"2",max:"2"}),e.functions.first=function(t,n){return e.standardFunctionAsync(t,n,function(){var e=(0,i.Z)((0,r.Z)().mark((function e(t,n,a){var i,s;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((0,p.p)(a,1,1),!(0,p.y)(a[0])){e.next=8;break}return e.next=3,a[0].first(t.abortSignal);case 3:if(null===(i=e.sent)){e.next=7;break}return s=c.Z.createFromGraphicLikeObject(i.geometry,i.attributes,a[0]),e.abrupt("return",(s._underlyingGraphic=i,s));case 7:return e.abrupt("return",i);case 8:return e.abrupt("return",(0,p.l)(a[0])?0===a[0].length?null:a[0][0]:(0,p.n)(a[0])?0===a[0].length()?null:a[0].get(0):null);case 9:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}())},e.signatures.push({name:"first",min:"1",max:"1"}),e.functions.attachments=function(t,n){return e.standardFunctionAsync(t,n,function(){var e=(0,i.Z)((0,r.Z)().mark((function e(n,a,i){var s,c,u;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((0,p.p)(i,1,2),s={minsize:-1,maxsize:-1,types:null,returnMetadata:!1},!(i.length>1)){e.next=9;break}if(!(i[1]instanceof l.Z)){e.next=7;break}i[1].hasField("minsize")&&(s.minsize=(0,p.f)(i[1].field("minsize"))),i[1].hasField("metadata")&&(s.returnMetadata=(0,p.g)(i[1].field("metadata"))),i[1].hasField("maxsize")&&(s.maxsize=(0,p.f)(i[1].field("maxsize"))),i[1].hasField("types")&&(c=(0,p.Y)(i[1].field("types"),!1)).length>0&&(s.types=c),e.next=9;break;case 7:if(null===i[1]){e.next=9;break}throw new Error("Invalid Parameter");case 9:if(!(0,p.s)(i[0])){e.next=25;break}if((u=i[0]._layer)instanceof Z.default&&(u=(0,o.constructFeatureSet)(u,t.spatialReference,["*"],!0,t.lrucache,t.interceptor)),null!==u){e.next=16;break}e.t0=[],e.next=24;break;case 16:if(!1!==(0,p.y)(u)){e.next=20;break}e.t1=[],e.next=23;break;case 20:return e.next=22,u.load();case 22:e.t1=u.queryAttachments(i[0].field(u.objectIdField),s.minsize,s.maxsize,s.types,s.returnMetadata);case 23:e.t0=e.t1;case 24:return e.abrupt("return",e.t0);case 25:if(null!==i[0]){e.next=27;break}return e.abrupt("return",[]);case 27:throw new Error("Invalid Parameter");case 28:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}())},e.signatures.push({name:"attachments",min:"1",max:"2"}),e.functions.featuresetbyrelationshipname=function(t,n){return e.standardFunctionAsync(t,n,function(){var e=(0,i.Z)((0,r.Z)().mark((function e(n,a,i){var s,l,c,u,f,d,y,b,h,m,g,v;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((0,p.p)(i,2,4),s=i[0],l=(0,p.h)(i[1]),c=(0,p.C)(i[2],null),u=(0,p.g)((0,p.C)(i[3],!0)),null===c&&(c=["*"]),!1!==(0,p.l)(c)){e.next=6;break}throw new Error("Invalid Parameter");case 6:if(null!==i[0]){e.next=8;break}return e.abrupt("return",null);case 8:if((0,p.s)(i[0])){e.next=10;break}throw new Error("Invalid Parameter");case 10:if((f=s._layer)instanceof Z.default&&(f=(0,o.constructFeatureSet)(f,t.spatialReference,["*"],!0,t.lrucache,t.interceptor)),null!==f){e.next=13;break}return e.abrupt("return",null);case 13:if(!1!==(0,p.y)(f)){e.next=15;break}return e.abrupt("return",null);case 15:return e.next=17,f.load();case 17:if(f=e.sent,d=f.relationshipMetaData().filter((function(e){return e.name===l})),0!==d.length){e.next=21;break}return e.abrupt("return",null);case 21:if(!(void 0!==d[0].relationshipTableId&&null!==d[0].relationshipTableId&&d[0].relationshipTableId>-1)){e.next=23;break}return e.abrupt("return",(0,o.constructFeatureSetFromRelationship)(f,d[0],s.field(f.objectIdField),f.spatialReference,c,u,t.lrucache,t.interceptor));case 23:if(y=f.serviceUrl()){e.next=26;break}return e.abrupt("return",null);case 26:return y="/"===y.charAt(y.length-1)?y+d[0].relatedTableId.toString():y+"/"+d[0].relatedTableId.toString(),e.next=29,(0,o.constructFeatureSetFromUrl)(y,f.spatialReference,c,u,t.lrucache,t.interceptor);case 29:return b=e.sent,e.next=32,b.load();case 32:if(h=(h=b.relationshipMetaData()).filter((function(e){return e.id===d[0].id})),!1!==s.hasField(d[0].keyField)&&null!==s.field(d[0].keyField)){e.next=41;break}return e.next=36,f.getFeatureByObjectId(s.field(f.objectIdField),[d[0].keyField]);case 36:if(!(m=e.sent)){e.next=40;break}return g=I.WhereClause.create(h[0].keyField+"= @id",b.getFieldsIndex()),e.abrupt("return",(g.parameters={id:m.attributes[d[0].keyField]},b.filter(g)));case 40:return e.abrupt("return",new x.Z({parentfeatureset:b}));case 41:return v=I.WhereClause.create(h[0].keyField+"= @id",b.getFieldsIndex()),e.abrupt("return",(v.parameters={id:s.field(d[0].keyField)},b.filter(v)));case 43:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}())},e.signatures.push({name:"featuresetbyrelationshipname",min:"2",max:"4"}),e.functions.featuresetbyassociation=function(t,n){return e.standardFunctionAsync(t,n,function(){var e=(0,i.Z)((0,r.Z)().mark((function e(n,i,s){var l,c,u,f,d,b,h,m,x,g,v,w,F,E,N,A,S,C,T,L,O,P,R,W,M,G,j,B,V,H,X,z,J,U,_,q,Q,$,K;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((0,p.p)(s,2,3),l=s[0],c=(0,p.h)((0,p.C)(s[1],"")).toLowerCase(),u=(0,p.b)(s[2])?(0,p.h)(s[2]):null,null!==s[0]){e.next=4;break}return e.abrupt("return",null);case 4:if((0,p.s)(s[0])){e.next=6;break}throw new Error("Invalid Parameter");case 6:if((f=l._layer)instanceof Z.default&&(f=(0,o.constructFeatureSet)(f,t.spatialReference,["*"],!0,t.lrucache,t.interceptor)),null!==f){e.next=9;break}return e.abrupt("return",null);case 9:if(!1!==(0,p.y)(f)){e.next=11;break}return e.abrupt("return",null);case 11:return e.next=13,f.load();case 13:return d=f.serviceUrl(),e.next=16,(0,o.constructAssociationMetaDataFeatureSetFromUrl)(d,t.spatialReference);case 16:if(b=e.sent,h=null,m=null,x=!1,null!==u&&""!==u&&void 0!==u){g=(0,a.Z)(b.terminals);try{for(g.s();!(v=g.n()).done;)(w=v.value).terminalName===u&&(m=w.terminalId)}catch(n){g.e(n)}finally{g.f()}null===m&&(x=!0)}F=b.associations.getFieldsIndex(),E=F.get("TOGLOBALID").name,N=F.get("FROMGLOBALID").name,A=F.get("TOTERMINALID").name,S=F.get("FROMTERMINALID").name,C=F.get("FROMNETWORKSOURCEID").name,T=F.get("TONETWORKSOURCEID").name,L=F.get("ASSOCIATIONTYPE").name,O=F.get("ISCONTENTVISIBLE").name,P=F.get("OBJECTID").name,R=(0,a.Z)(f.fields),e.prev=21,R.s();case 23:if((W=R.n()).done){e.next=30;break}if("global-id"!==(M=W.value).type){e.next=28;break}return h=l.field(M.name),e.abrupt("break",30);case 28:e.next=23;break;case 30:e.next=35;break;case 32:e.prev=32,e.t0=e.catch(21),R.e(e.t0);case 35:return e.prev=35,R.f(),e.finish(35);case 38:for(z in G=null,j=new y.yN(new D.Z({name:"percentalong",alias:"percentalong",type:"double"}),I.WhereClause.create("0",b.associations.getFieldsIndex())),B=new y.yN(new D.Z({name:"side",alias:"side",type:"string"}),I.WhereClause.create("''",b.associations.getFieldsIndex())),V="globalid",H="globalId",X={},b.lkp)X[z]=b.lkp[z].sourceId;J=new y.TO(new D.Z({name:"classname",alias:"classname",type:"string"}),null,X),U="",e.t1=c,e.next="midspan"===e.t1?46:"junctionedge"===e.t1?50:"connected"===e.t1?54:"container"===e.t1?59:"content"===e.t1?60:"structure"===e.t1?62:"attached"===e.t1?64:66;break;case 46:return U="((".concat(E,"='").concat(h,"') OR ( ").concat(N,"='").concat(h,"')) AND (").concat(L," IN (5))"),J.codefield=I.WhereClause.create("CASE WHEN (".concat(E,"='").concat(h,"') THEN ").concat(C," ELSE ").concat(T," END"),b.associations.getFieldsIndex()),(_=(0,k.JW)(y.Xx.findField(b.associations.fields,N))).name=V,_.alias=V,G=new y.yN(_,I.WhereClause.create("CASE WHEN (".concat(N,"='").concat(h,"') THEN ").concat(E," ELSE ").concat(N," END"),b.associations.getFieldsIndex())),j=b.unVersion>=4?new y.$X(y.Xx.findField(b.associations.fields,F.get("PERCENTALONG").name)):new y.yN(new D.Z({name:"percentalong",alias:"percentalong",type:"double"}),I.WhereClause.create("0",b.associations.getFieldsIndex())),e.abrupt("break",67);case 50:return U="((".concat(E,"='").concat(h,"') OR ( ").concat(N,"='").concat(h,"')) AND (").concat(L," IN (4,6))"),J.codefield=I.WhereClause.create("CASE WHEN (".concat(E,"='").concat(h,"') THEN ").concat(C," ELSE ").concat(T," END"),b.associations.getFieldsIndex()),(q=(0,k.JW)(y.Xx.findField(b.associations.fields,N))).name=V,q.alias=V,G=new y.yN(q,I.WhereClause.create("CASE WHEN (".concat(N,"='").concat(h,"') THEN ").concat(E," ELSE ").concat(N," END"),b.associations.getFieldsIndex())),B=new y.yN(new D.Z({name:"side",alias:"side",type:"string"}),I.WhereClause.create("CASE WHEN (".concat(L,"=4) THEN 'from' ELSE 'to' END"),b.associations.getFieldsIndex())),e.abrupt("break",67);case 54:return Q="".concat(E,"='@T'"),$="".concat(N,"='@T'"),null!==m&&(Q+=" AND ".concat(A,"=@A"),$+=" AND ".concat(S,"=@A")),U="(("+Q+") OR ("+$+"))",U=(0,p.M)(U,"@T",h),Q=(0,p.M)(Q,"@T",h),null!==m&&(Q=(0,p.M)(Q,"@A",m.toString()),U=(0,p.M)(U,"@A",m.toString())),J.codefield=I.WhereClause.create("CASE WHEN "+Q+" THEN ".concat(C," ELSE ").concat(T," END"),b.associations.getFieldsIndex()),(K=(0,k.JW)(y.Xx.findField(b.associations.fields,N))).name=V,K.alias=V,G=new y.yN(K,I.WhereClause.create("CASE WHEN "+Q+" THEN ".concat(N," ELSE ").concat(E," END"),b.associations.getFieldsIndex())),e.abrupt("break",67);case 59:U="".concat(E,"='").concat(h,"' AND ").concat(L," = 2"),null!==m&&(U+=" AND ".concat(A," = ")+m.toString()),J.codefield=C,U="( "+U+" )",G=new y.QP(y.Xx.findField(b.associations.fields,N),V,V);case 60:return U="(".concat(N,"='").concat(h,"' AND ").concat(L," = 2)"),null!==m&&(U+=" AND ".concat(S," = ")+m.toString()),J.codefield=T,U="( "+U+" )",G=new y.QP(y.Xx.findField(b.associations.fields,E),V,V),e.abrupt("break",67);case 62:return U="(".concat(E,"='").concat(h,"' AND ").concat(L," = 3)"),null!==m&&(U+=" AND ".concat(A," = ")+m.toString()),J.codefield=C,U="( "+U+" )",G=new y.QP(y.Xx.findField(b.associations.fields,N),V,H),e.abrupt("break",67);case 64:return U="(".concat(N,"='").concat(h,"' AND ").concat(L," = 3)"),null!==m&&(U+=" AND ".concat(S," = ")+m.toString()),J.codefield=T,U="( "+U+" )",G=new y.QP(y.Xx.findField(b.associations.fields,E),V,H),e.abrupt("break",67);case 66:throw new Error("Invalid Parameter");case 67:return x&&(U="1 <> 1"),e.abrupt("return",new y.Xx({parentfeatureset:b.associations,adaptedFields:[new y.$X(y.Xx.findField(b.associations.fields,P)),new y.$X(y.Xx.findField(b.associations.fields,O)),G,B,J,j],extraFilter:U?I.WhereClause.create(U,b.associations.getFieldsIndex()):null}));case 69:case"end":return e.stop()}}),e,null,[[21,32,35,38]])})));return function(t,n,r){return e.apply(this,arguments)}}())},e.signatures.push({name:"featuresetbyassociation",min:"2",max:"6"}),e.functions.groupby=function(t,n){return e.standardFunctionAsync(t,n,function(){var n=(0,i.Z)((0,r.Z)().mark((function n(i,s,c){var u,o,f,d,y,b,h,m,x,g,v,k,F,E,Z,D,N,S,C,T,L,O,P,R,W,M,G,j,B,V,H,X,z,J,U,_,q,Q;return(0,r.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if((0,p.p)(c,3,3),(0,p.y)(c[0])){n.next=2;break}throw new Error("Illegal Value: GroupBy");case 2:return n.next=4,c[0].load();case 4:if(u=n.sent,o=[],f=[],d=!1,y=[],!(0,p.b)(c[1])){n.next=12;break}y.push(c[1]),n.next=23;break;case 12:if(!(c[1]instanceof l.Z)){n.next=16;break}y.push(c[1]),n.next=23;break;case 16:if(!(0,p.l)(c[1])){n.next=20;break}y=c[1],n.next=23;break;case 20:if((0,p.n)(c[1])){n.next=22;break}throw new Error("Illegal Value: GroupBy");case 22:y=c[1].toArray();case 23:b=(0,a.Z)(y),n.prev=24,b.s();case 26:if((h=b.n()).done){n.next=41;break}if(m=h.value,!(0,p.b)(m)){n.next=33;break}x=I.WhereClause.create((0,p.h)(m),u.getFieldsIndex()),g=!0===(0,w.y5)(x)?(0,p.h)(m):"%%%%FIELDNAME",o.push({name:g,expression:x}),"%%%%FIELDNAME"===g&&(d=!0),n.next=39;break;case 33:if(m instanceof l.Z){n.next=35;break}throw new Error("Illegal Value: GroupBy");case 35:if(v=m.hasField("name")?m.field("name"):"%%%%FIELDNAME",k=m.hasField("expression")?m.field("expression"):"","%%%%FIELDNAME"===v&&(d=!0),v){n.next=38;break}throw new Error("Illegal Value: GroupBy");case 38:o.push({name:v,expression:I.WhereClause.create(k||v,u.getFieldsIndex())});case 39:n.next=26;break;case 41:n.next=46;break;case 43:n.prev=43,n.t0=n.catch(24),b.e(n.t0);case 46:return n.prev=46,b.f(),n.finish(46);case 49:if(y=[],!(0,p.b)(c[2])){n.next=53;break}y.push(c[2]),n.next=64;break;case 53:if(!(0,p.l)(c[2])){n.next=57;break}y=c[2],n.next=64;break;case 57:if(!(0,p.n)(c[2])){n.next=61;break}y=c[2].toArray(),n.next=64;break;case 61:if(c[2]instanceof l.Z){n.next=63;break}throw new Error("Illegal Value: GroupBy");case 63:y.push(c[2]);case 64:F=(0,a.Z)(y),n.prev=65,F.s();case 67:if((E=F.n()).done){n.next=77;break}if((Z=E.value)instanceof l.Z){n.next=71;break}throw new Error("Illegal Value: GroupBy");case 71:if(D=Z.hasField("name")?Z.field("name"):"",N=Z.hasField("statistic")?Z.field("statistic"):"",S=Z.hasField("expression")?Z.field("expression"):"",D&&N&&S){n.next=74;break}throw new Error("Illegal Value: GroupBy");case 74:f.push({name:D,statistic:N.toLowerCase(),expression:I.WhereClause.create(S,u.getFieldsIndex())});case 75:n.next=67;break;case 77:n.next=82;break;case 79:n.prev=79,n.t1=n.catch(65),F.e(n.t1);case 82:return n.prev=82,F.f(),n.finish(82);case 85:if(d){C={},T=(0,a.Z)(u.fields);try{for(T.s();!(L=T.n()).done;)O=L.value,C[O.name.toLowerCase()]=1}catch(r){T.e(r)}finally{T.f()}P=(0,a.Z)(o);try{for(P.s();!(R=P.n()).done;)"%%%%FIELDNAME"!==(W=R.value).name&&(C[W.name.toLowerCase()]=1)}catch(r){P.e(r)}finally{P.f()}M=(0,a.Z)(f);try{for(M.s();!(G=M.n()).done;)"%%%%FIELDNAME"!==(j=G.value).name&&(C[j.name.toLowerCase()]=1)}catch(r){M.e(r)}finally{M.f()}B=0,V=(0,a.Z)(o);try{for(V.s();!(H=V.n()).done;)if("%%%%FIELDNAME"===(X=H.value).name){for(;1===C["field_"+B.toString()];)B++;C["field_"+B.toString()]=1,X.name="FIELD_"+B.toString()}}catch(r){V.e(r)}finally{V.f()}}z=0,J=o;case 87:if(!(z<J.length)){n.next=94;break}return U=J[z],n.next=91,A(U.expression,e,t);case 91:z++,n.next=87;break;case 94:_=0,q=f;case 95:if(!(_<q.length)){n.next=102;break}return Q=q[_],n.next=99,A(Q.expression,e,t);case 99:_++,n.next=95;break;case 102:return n.abrupt("return",c[0].groupby(o,f));case 103:case"end":return n.stop()}}),n,null,[[24,43,46,49],[65,79,82,85]])})));return function(e,t,r){return n.apply(this,arguments)}}())},e.signatures.push({name:"groupby",min:"3",max:"3"}),e.functions.distinct=function(t,n){return e.standardFunctionAsync(t,n,function(){var n=(0,i.Z)((0,r.Z)().mark((function n(i,s,c){var u,o,f,d,y,b,h,m,x,g,v,k,F,E,Z,D,S,C,T,L,O,P,R,W,M;return(0,r.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!(0,p.y)(c[0])){n.next=59;break}return(0,p.p)(c,2,2),n.next=4,c[0].load();case 4:if(u=n.sent,o=[],f=[],!(0,p.b)(c[1])){n.next=11;break}f.push(c[1]),n.next=22;break;case 11:if(!(c[1]instanceof l.Z)){n.next=15;break}f.push(c[1]),n.next=22;break;case 15:if(!(0,p.l)(c[1])){n.next=19;break}f=c[1],n.next=22;break;case 19:if((0,p.n)(c[1])){n.next=21;break}throw new Error("Illegal Value: GroupBy");case 21:f=c[1].toArray();case 22:d=!1,y=(0,a.Z)(f),n.prev=24,y.s();case 26:if((b=y.n()).done){n.next=41;break}if(h=b.value,!(0,p.b)(h)){n.next=33;break}m=I.WhereClause.create((0,p.h)(h),u.getFieldsIndex()),x=!0===(0,w.y5)(m)?(0,p.h)(h):"%%%%FIELDNAME",o.push({name:x,expression:m}),"%%%%FIELDNAME"===x&&(d=!0),n.next=39;break;case 33:if(h instanceof l.Z){n.next=35;break}throw new Error("Illegal Value: GroupBy");case 35:if(g=h.hasField("name")?h.field("name"):"%%%%FIELDNAME",v=h.hasField("expression")?h.field("expression"):"","%%%%FIELDNAME"===g&&(d=!0),g){n.next=38;break}throw new Error("Illegal Value: GroupBy");case 38:o.push({name:g,expression:I.WhereClause.create(v||g,u.getFieldsIndex())});case 39:n.next=26;break;case 41:n.next=46;break;case 43:n.prev=43,n.t0=n.catch(24),y.e(n.t0);case 46:return n.prev=46,y.f(),n.finish(46);case 49:if(d){k={},F=(0,a.Z)(u.fields);try{for(F.s();!(E=F.n()).done;)Z=E.value,k[Z.name.toLowerCase()]=1}catch(r){F.e(r)}finally{F.f()}D=(0,a.Z)(o);try{for(D.s();!(S=D.n()).done;)"%%%%FIELDNAME"!==(C=S.value).name&&(k[C.name.toLowerCase()]=1)}catch(r){D.e(r)}finally{D.f()}T=0,L=(0,a.Z)(o);try{for(L.s();!(O=L.n()).done;)if("%%%%FIELDNAME"===(P=O.value).name){for(;1===k["field_"+T.toString()];)T++;k["field_"+T.toString()]=1,P.name="FIELD_"+T.toString()}}catch(r){L.e(r)}finally{L.f()}}R=0,W=o;case 51:if(!(R<W.length)){n.next=58;break}return M=W[R],n.next=55,A(M.expression,e,t);case 55:R++,n.next=51;break;case 58:return n.abrupt("return",c[0].groupby(o,[]));case 59:return n.abrupt("return",N("distinct",0,0,c));case 60:case"end":return n.stop()}}),n,null,[[24,43,46,49]])})));return function(e,t,r){return n.apply(this,arguments)}}())})}}}]);
//# sourceMappingURL=718.23bb682a.chunk.js.map