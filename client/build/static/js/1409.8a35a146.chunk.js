"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[1409],{85981:function(t,n,e){e.d(n,{AR:function(){return m},Gr:function(){return l},JG:function(){return s},Jk:function(){return h},KU:function(){return g},Ue:function(){return c},al:function(){return f},ct:function(){return p},nF:function(){return v},zk:function(){return d}});var r=e(16889),i=e(21530),o=e(11186),u=e(71353),a=e(11185);function c(t){return t?{origin:(0,u.a)(t.origin),vector:(0,u.a)(t.vector)}:{origin:(0,u.c)(),vector:(0,u.c)()}}function s(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:c();return f(t.origin,t.vector,n)}function f(t,n){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:c();return(0,o.c)(e.origin,t),(0,o.c)(e.vector,n),e}function d(t,n){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:c();return(0,o.c)(e.origin,t),(0,o.b)(e.vector,n,t),e}function h(t,n){var e=(0,o.b)(a.WM.get(),n,t.origin),i=(0,o.e)(t.vector,e),u=(0,o.e)(t.vector,t.vector),c=(0,r.uZ)(i/u,0,1),s=(0,o.b)(a.WM.get(),(0,o.g)(a.WM.get(),t.vector,c),e);return(0,o.e)(s,s)}function v(t,n,e){return p(t,n,0,1,e)}function g(t,n,e){return(0,o.a)(e,t.origin,(0,o.g)(e,t.vector,n))}function p(t,n,e,i,u){var c=t.vector,s=t.origin,f=(0,o.b)(a.WM.get(),n,s),d=(0,o.e)(c,f)/(0,o.p)(c);return(0,o.g)(u,c,(0,r.uZ)(d,e,i)),(0,o.a)(u,u,t.origin)}function l(t,n){if(b(t,function(t,n){var e=M.get();return e.origin=t,e.vector=n,e}(n.origin,n.direction),!1,_)){var e=_.tA,r=_.pB,i=_.distance2;if(e>=0&&e<=1)return i;if(e<0)return(0,o.d)(t.origin,r);if(e>1)return(0,o.d)((0,o.a)(a.WM.get(),t.origin,t.vector),r)}return null}function m(t,n,e){return!!b(t,n,!0,_)&&((0,o.c)(e,_.pA),!0)}function b(t,n,e,i){var u=1e-6,c=t.origin,s=(0,o.a)(a.WM.get(),c,t.vector),f=n.origin,d=(0,o.a)(a.WM.get(),f,n.vector),h=a.WM.get(),v=a.WM.get();if(h[0]=c[0]-f[0],h[1]=c[1]-f[1],h[2]=c[2]-f[2],v[0]=d[0]-f[0],v[1]=d[1]-f[1],v[2]=d[2]-f[2],Math.abs(v[0])<u&&Math.abs(v[1])<u&&Math.abs(v[2])<u)return!1;var g=a.WM.get();if(g[0]=s[0]-c[0],g[1]=s[1]-c[1],g[2]=s[2]-c[2],Math.abs(g[0])<u&&Math.abs(g[1])<u&&Math.abs(g[2])<u)return!1;var p=h[0]*v[0]+h[1]*v[1]+h[2]*v[2],l=v[0]*g[0]+v[1]*g[1]+v[2]*g[2],m=h[0]*g[0]+h[1]*g[1]+h[2]*g[2],b=v[0]*v[0]+v[1]*v[1]+v[2]*v[2],_=(g[0]*g[0]+g[1]*g[1]+g[2]*g[2])*b-l*l;if(Math.abs(_)<u)return!1;var M=(p*l-m*b)/_,k=(p+l*M)/b;e&&(M=(0,r.uZ)(M,0,1),k=(0,r.uZ)(k,0,1));var y=a.WM.get(),Z=a.WM.get();return y[0]=c[0]+M*g[0],y[1]=c[1]+M*g[1],y[2]=c[2]+M*g[2],Z[0]=f[0]+k*v[0],Z[1]=f[1]+k*v[1],Z[2]=f[2]+k*v[2],i.tA=M,i.tB=k,i.pA=y,i.pB=Z,i.distance2=(0,o.d)(y,Z),!0}var _={tA:0,tB:0,pA:(0,u.c)(),pB:(0,u.c)(),distance2:0},M=new i.x((function(){return{origin:null,vector:null}}))},97731:function(t,n,e){e.d(n,{E6:function(){return d},Kj:function(){return g},RQ:function(){return m},T:function(){return c},ep:function(){return f},hu:function(){return a},kG:function(){return v},tM:function(){return l},u_:function(){return h},yK:function(){return s},zF:function(){return p}});var r=e(15671),i=e(43144),o=e(6394),u=(e(90045),(0,e(67077).c)(),function(){function t(n){(0,r.Z)(this,t),this.message=n}return(0,i.Z)(t,[{key:"toString",value:function(){return"AssertException: ".concat(this.message)}}]),t}());function a(t,n){if(!t)throw n=n||"assert",console.log(new Error(n).stack),new u(n)}function c(t,n){t||(n=n||"",console.warn("Verify failed: "+n+"\n"+new Error("verify").stack))}function s(t,n,e,r){var i,o=(e[0]-t[0])/n[0],u=(r[0]-t[0])/n[0];o>u&&(i=o,o=u,u=i);var a=(e[1]-t[1])/n[1],c=(r[1]-t[1])/n[1];if(a>c&&(i=a,a=c,c=i),o>c||a>u)return!1;a>o&&(o=a),c<u&&(u=c);var s=(e[2]-t[2])/n[2],f=(r[2]-t[2])/n[2];return s>f&&(i=s,s=f,f=i),!(o>f||s>u)&&(f<u&&(u=f),!(u<0))}function f(t,n,e,r,i){var u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:(0,o.a)(),a=(r[i]-e[i])*(n[0]-t[0])-(r[0]-e[0])*(n[i]-t[i]),c=(r[0]-e[0])*(t[i]-e[i])-(r[i]-e[i])*(t[0]-e[0]);if(0===a)return!1;var s=c/a;return u[0]=t[0]+s*(n[0]-t[0]),u[1]=t[i]+s*(n[i]-t[i]),!0}function d(t,n){return Math.log(t)/Math.log(n)}function h(t,n,e,r){t[12]=n,t[13]=e,t[14]=r}function v(t){return 1===t[0]&&0===t[1]&&0===t[2]&&0===t[3]&&0===t[4]&&1===t[5]&&0===t[6]&&0===t[7]&&0===t[8]&&0===t[9]&&1===t[10]&&0===t[11]&&1===t[15]}function g(t,n,e){return 2*Math.atan(Math.sqrt(n*n+e*e)*Math.tan(.5*t)/n)}function p(t,n,e){return 2*Math.atan(Math.sqrt(n*n+e*e)*Math.tan(.5*t)/e)}function l(t,n,e){return 2*Math.atan(n*Math.tan(.5*t)/Math.sqrt(n*n+e*e))}function m(t,n,e){return 2*Math.atan(e*Math.tan(.5*t)/Math.sqrt(n*n+e*e))}},54357:function(t,n,e){e.r(n),e.d(n,{SceneLayerSnappingSourceWorker:function(){return _},default:function(){return M}});var r=e(37762),i=e(74165),o=e(15861),u=e(15671),a=e(43144),c=e(27366),s=e(92026),f=e(66978),d=(e(32718),e(25243),e(63780),e(93169),e(75366),e(69912)),h=e(11186),v=e(71353),g=e(85981),p=e(23470),l=e(92536),m=e(78329),b=e(11438),_=function(){function t(){(0,u.Z)(this,t),this._idToComponent=new Map,this._components=new m.Z((function(t){return t.bounds})),this._edges=new m.Z((function(t){return t.bounds})),this._tmpLineSegment=(0,g.Ue)(),this._tmpP1=(0,v.c)(),this._tmpP2=(0,v.c)(),this._tmpP3=(0,v.c)(),this.remoteClient=null}return(0,a.Z)(t,[{key:"fetchCandidates",value:function(){var t=(0,o.Z)((0,i.Z)().mark((function t(n,e){var r,o=this;return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.resolve();case 2:return(0,f.k_)(e),t.next=5,this._ensureEdgeLocations(n,e);case 5:return r=[],t.abrupt("return",(this._edges.forEachNeighbor((function(t){return o._addCandidates(n,t,r)}),n.bounds),{result:{candidates:r}}));case 7:case"end":return t.stop()}}),t,this)})));return function(n,e){return t.apply(this,arguments)}}()},{key:"_ensureEdgeLocations",value:function(){var t=(0,o.Z)((0,i.Z)().mark((function t(n,e){var o,u,a,c,f,d;return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o=[],this._components.forEachNeighbor((function(t){if((0,s.Wi)(t.info)){var n=t.id,e=t.uid;o.push({id:n,uid:e})}}),n.bounds),o.length){t.next=3;break}return t.abrupt("return");case 3:return u={components:o},t.next=6,this.remoteClient.invoke("fetchAllEdgeLocations",u,(0,s.Pt)(e,{}));case 6:a=t.sent,c=(0,r.Z)(a.components);try{for(c.s();!(f=c.n()).done;)d=f.value,this._setFetchEdgeLocations(d)}catch(i){c.e(i)}finally{c.f()}case 9:case"end":return t.stop()}}),t,this)})));return function(n,e){return t.apply(this,arguments)}}()},{key:"add",value:function(){var t=(0,o.Z)((0,i.Z)().mark((function t(n){var e;return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=new k(n.id,n.bounds),t.abrupt("return",(this._idToComponent.set(e.id,e),this._components.add([e]),{result:{}}));case 2:case"end":return t.stop()}}),t,this)})));return function(n){return t.apply(this,arguments)}}()},{key:"remove",value:function(){var t=(0,o.Z)((0,i.Z)().mark((function t(n){var e,r;return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(e=this._idToComponent.get(n.id))&&(r=[],this._edges.forEachNeighbor((function(t){t.component===e&&r.push(t)}),e.bounds),this._edges.remove(r),this._components.remove([e]),this._idToComponent.delete(e.id)),t.abrupt("return",{result:{}});case 3:case"end":return t.stop()}}),t,this)})));return function(n){return t.apply(this,arguments)}}()},{key:"_setFetchEdgeLocations",value:function(t){var n=this._idToComponent.get(t.id);if(!(0,s.Wi)(n)&&t.uid===n.uid){for(var e=b.extractComponentsEdgeLocationsLayout.createView(t.locations),r=new Array(e.count),i=(0,v.c)(),o=(0,v.c)(),u=0;u<e.count;u++){var a=(0,p.c)(),c=(0,p.g)(a);e.position0.getVec(u,i),e.position1.getVec(u,o),(0,h.C)(c,c,i,.5),(0,h.C)(c,c,o,.5),(0,h.a)(c,c,t.origin),a[3]=(0,h.i)(c,i);var f=new y(n,u,a);r[u]=f}this._edges.add(r);var d=t.objectIds,g=t.origin;n.info={locations:e,objectIds:d,origin:g}}}},{key:"_addCandidates",value:function(t,n,e){var r=n.component.info,i=r.locations,o=r.origin,u=r.objectIds,a=i.position0.getVec(n.index,this._tmpP1),c=i.position1.getVec(n.index,this._tmpP2);(0,h.a)(a,a,o),(0,h.a)(c,c,o);var s=u[i.componentIndex.get(n.index)];this._addEdgeCandidate(t,s,a,c,e),this._addVertexCandidate(t,s,a,e),this._addVertexCandidate(t,s,c,e)}},{key:"_addEdgeCandidate",value:function(t,n,e,r,i){if(t.types&l.r.EDGE){var o=(0,p.g)(t.bounds),u=(0,g.zk)(e,r,this._tmpLineSegment),a=(0,g.nF)(u,o,this._tmpP3);if(!(0,p.m)(t.bounds,a))return null;i.push({type:"edge",objectId:n,target:(0,v.a)(a),distance:(0,h.i)(o,a),start:(0,v.a)(e),end:(0,v.a)(r)})}}},{key:"_addVertexCandidate",value:function(t,n,e,r){if(t.types&l.r.VERTEX){var i=(0,p.g)(t.bounds);if(!(0,p.m)(t.bounds,e))return null;r.push({type:"vertex",objectId:n,target:(0,v.a)(e),distance:(0,h.i)(i,e)})}}}]),t}();function M(){return new _}_=(0,c._)([(0,d.j)("esri.views.interactive.snapping.featureSources.sceneLayerSource.SceneLayerSnappingSourceWorker")],_);var k=(0,a.Z)((function t(n,e){(0,u.Z)(this,t),this.id=n,this.bounds=e,this.info=null,this.uid=++t.uid}));k.uid=0;var y=(0,a.Z)((function t(n,e,r){(0,u.Z)(this,t),this.component=n,this.index=e,this.bounds=r}))}}]);
//# sourceMappingURL=1409.8a35a146.chunk.js.map